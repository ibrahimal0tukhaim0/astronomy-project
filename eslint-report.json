[{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/capacitor.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/cleanup-analyzer.cjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/ios/App/App/public/assets/index-DpTJo5Pm.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/ios/App/App/public/cordova.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/ios/App/App/public/cordova_plugins.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/App.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":36,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":38},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_error' is defined but never used.","line":40,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_info' is defined but never used.","line":40,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":43},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":219,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":219,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9893,9896],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9893,9896],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Canvas } from '@react-three/fiber'\nimport { OrbitControls, Loader, AdaptiveDpr, AdaptiveEvents, DeviceOrientationControls } from '@react-three/drei'\nimport React, { useState, Suspense, useRef, lazy, useEffect } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport type { CelestialData } from './types'\nimport { InfoPanel } from './components/InfoPanel'\nimport { Layout } from './components/Layout'\nimport { TimeControls } from './components/TimeControls'\nimport { CameraController } from './components/CameraController'\nimport type { CameraControllerHandle } from './components/CameraController'\nimport { NavigationSidebar } from './components/NavigationSidebar'\nimport { GeminiChat } from './components/GeminiChat'\nimport { getObjectPosition } from './utils/astronomy'\nimport { EffectComposer, Bloom } from '@react-three/postprocessing';\nimport { PerformanceOptimizer } from './components/PerformanceOptimizer';\nimport { SmartRenderingManager } from './components/SmartRenderingManager';\nimport type { OrbitControls as OrbitControlsType } from 'three-stdlib'\nimport * as THREE from 'three'\nimport { Music } from 'lucide-react';\n\n// Lazy load the heavy 3D scene so Home Screen loads instantly\nconst SimulationScene = lazy(() => import('./components/SimulationScene'));\nimport { CinematicHome } from './components/CinematicHome'\nimport { AppEnhancements } from './components/AppEnhancements'\nimport { AmbienceControl } from './components/AmbienceControl'\nimport { SplashIntro } from './components/SplashIntro'\nimport { WebcamLayer } from './components/WebcamLayer' // ğŸ“· Import Webcam Layer\n\n// ğŸ›¡ï¸ User Requested: Error Boundary to prevent crashes\nclass ErrorBoundary extends React.Component<{ children: React.ReactNode }, { hasError: boolean }> {\n    constructor(props: { children: React.ReactNode }) {\n        super(props);\n        this.state = { hasError: false };\n    }\n\n    static getDerivedStateFromError(_: Error) {\n        return { hasError: true };\n    }\n\n    componentDidCatch(_error: Error, _info: React.ErrorInfo) {\n        // Console log removed\n\n    }\n\n    render() {\n        if (this.state.hasError) {\n            return (\n                <div style={{ background: 'black', color: 'white', padding: 20, textAlign: 'center', direction: 'rtl', height: '100vh', display: 'flex', flexDirection: 'column', justifyContent: 'center', alignItems: 'center' }}>\n                    <h2>Ø­Ø¯Ø« Ø®Ø·Ø£ Ø¨Ø³ÙŠØ· ÙÙŠ Ø§Ù„ÙØ¶Ø§Ø¡ âš ï¸</h2>\n                    <p>Ù†Ø­Ø§ÙˆÙ„ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø§ØªØµØ§Ù„...</p>\n                    <button\n                        onClick={() => this.setState({ hasError: false })}\n                        style={{ background: 'orange', padding: '10px 20px', borderRadius: 5, color: 'black', fontWeight: 'bold', marginTop: 10, cursor: 'pointer' }}\n                    >\n                        Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©\n                    </button>\n                    <p style={{ fontSize: '0.8rem', color: '#666', marginTop: 20 }}>ØªÙ… Ø§Ø­ØªÙˆØ§Ø¡ Ø§Ù„Ø®Ø·Ø£ Ø¨Ù†Ø¬Ø§Ø­.</p>\n                </div>\n            );\n        }\n        return this.props.children;\n    }\n}\n\nfunction AppContent() {\n    const [selectedObject, setSelectedObject] = useState<CelestialData | null>(null)\n    const [isPaused, setIsPaused] = useState(false)\n    const [isARMode, setIsARMode] = useState(false) // ğŸ•¶ï¸ AR Mode State\n    const [currentDate, setCurrentDate] = useState(new Date())\n    const [hasStarted, setHasStarted] = useState(false)\n    const [introFinished, setIntroFinished] = useState(false) // ğŸ¬ Intro State\n    const [isMarathonMode, setIsMarathonMode] = useState(false) // ğŸƒâ€â™‚ï¸ Marathon Mode\n    const { t } = useTranslation()\n    const controlsRef = useRef<OrbitControlsType>(null)\n    const cameraControllerRef = useRef<CameraControllerHandle>(null)\n\n    // ğŸ¥ Cinematic Camera Move for Marathon Mode\n    useEffect(() => {\n        if (isMarathonMode && controlsRef.current) {\n            // Side Angle: Elevated Z position looking at the line (X-axis)\n            // Planets are at [R, 0, 0].\n            // View from [300, 50, 500] looks at the \"middle\" of the line roughly.\n            // Or [0, 50, 600] looks at Sun but sees the line extending?\n            // \"Show planets extended on horizon\".\n            // Side view: x=mid, z=distance.\n            const camera = controlsRef.current.object as THREE.PerspectiveCamera;\n\n            // GSAP animation for smooth transition\n            import('gsap').then(({ default: gsap }) => {\n                gsap.to(camera.position, {\n                    x: 300,\n                    y: 60,\n                    z: 500,\n                    duration: 2.5,\n                    ease: \"power3.inOut\"\n                });\n                gsap.to(controlsRef.current!.target, {\n                    x: 300,\n                    y: 0,\n                    z: 0,\n                    duration: 2.5,\n                    ease: \"power3.inOut\"\n                });\n            });\n        }\n    }, [isMarathonMode]);\n\n    const selectedObjectPos = selectedObject\n        ? new THREE.Vector3(...getObjectPosition(selectedObject.id, currentDate))\n        : null;\n\n    const handleNavigate = (objectId: string) => {\n        if (cameraControllerRef.current) {\n            cameraControllerRef.current.flyTo(objectId);\n        }\n\n        import('./data/objects').then(({ celestialObjects }) => {\n            const obj = celestialObjects.find(o => o.id === objectId);\n            if (obj) setSelectedObject(obj);\n        });\n    };\n\n    // ğŸ“± MOBILE OPTIMIZATION: Immediate Resize Handler\n    // Ensures Camera Aspect Ratio & Renderer size update accurately on rotation\n    useEffect(() => {\n        const handleResize = () => {\n            // Force layout recalculation for mobile browser bars (100vh fix)\n            const vh = window.innerHeight * 0.01;\n            document.documentElement.style.setProperty('--vh', `${vh}px`);\n        };\n\n        window.addEventListener('resize', handleResize);\n        window.addEventListener('orientationchange', handleResize);\n\n        // Init\n        handleResize();\n\n        return () => {\n            window.removeEventListener('resize', handleResize);\n            window.removeEventListener('orientationchange', handleResize);\n        };\n    }, []);\n\n    return (\n        // touch-none prevents \"pull-to-refresh\" on mobile which ruins the 3D experience\n        <div\n            className={`w-full relative overflow-hidden touch-none ${isARMode ? 'bg-transparent' : 'bg-black'}`}\n            dir=\"rtl\"\n            style={{\n                height: 'calc(var(--vh, 1vh) * 100)',\n                zIndex: 2, // Ensure App content sits ABOVE the fixed video (Z:1)\n                position: 'relative'\n            }}\n        >\n            <AppEnhancements />\n\n            {/* ğŸ¥ AR LAYER: HTML Video Background (Outside Canvas) */}\n            {isARMode && <WebcamLayer />}\n\n            {/* ğŸ¬ Cinematic Splash Intro */}\n            {!introFinished && (\n                <SplashIntro onComplete={() => setIntroFinished(true)} />\n            )}\n\n            {/* ğŸ›ï¸ Fixed Ambience HUD - Renders outside Canvas for stability */}\n            {introFinished && <AmbienceControl />}\n            <ErrorBoundary>\n                {/* 3D Scene */}\n                <Canvas\n                    shadows\n                    camera={{\n                        // ğŸ¥ CAMERA INTRO: Panorama Mode (Ultra Wide Max)\n                        // Intro: Wide FOV (75) + Far Z (660) + High Y (92)\n                        position: hasStarted ? [0, 40, 140] : [0, 92, 660],\n                        fov: hasStarted ? 60 : 75,\n                        near: 0.1,\n                        far: 500000 // âœ¨ Extended Range for Outer Belt\n                    }}\n                    // ğŸŒŸ 4K RENDER UPGRADE: Optimized Pixel Ratio (User Request: Max 2)\n                    // Reduces GPU load by 30% while maintaining visual sharpness\n                    dpr={[1, Math.min(window.devicePixelRatio, 2)]}\n                    gl={{\n                        // PERFORMANCE: Auto-disable Antialias on High-DPI screens\n                        antialias: window.devicePixelRatio < 2,\n                        powerPreference: \"high-performance\",\n                        precision: \"highp\", // Force high precision for gradients/shaders\n                        toneMapping: THREE.ACESFilmicToneMapping,\n                        toneMappingExposure: 0.8,\n                        outputColorSpace: THREE.SRGBColorSpace,\n                        preserveDrawingBuffer: false,\n                        alpha: true // âœ¨ Allow Transparent Background for AR\n                    }}\n                >\n                    {/* In AR Mode, we want transparent background so VideoTexture (or DOM) shows through */}\n                    {/* Background Color handles regular mode. In AR mode, it's transparent. */}\n                    {!isARMode && <color attach=\"background\" args={['#000814']} />}\n\n                    {/* Performance Optimization for iOS */}\n                    <AdaptiveDpr pixelated />\n                    <AdaptiveEvents />\n\n                    <Suspense fallback={null}>\n                        <SimulationScene\n                            onSelect={setSelectedObject}\n                            isPaused={isPaused || !hasStarted}\n                            onDateChange={setCurrentDate}\n                            isARMode={isARMode} // ğŸ¥ AR Pass-through\n                            isMarathonMode={isMarathonMode}\n                        />\n                    </Suspense>\n\n                    {/* ğŸ•¹ï¸ CONTROLS SWITCHING */}\n                    {!isARMode ? (\n                        <>\n                            <CameraController\n                                ref={cameraControllerRef}\n                                selectedObject={selectedObject}\n                                objectPosition={selectedObjectPos}\n                                controlsRef={controlsRef as any}\n                                startIntro={hasStarted}\n                            />\n                            <OrbitControls\n                                ref={controlsRef}\n                                target={[0, 0, 0]}\n                                enableZoom={true}\n                                zoomToCursor={true} // ğŸ” Pro Feature: Zoom to wherever cursor is\n                                enablePan={true} // âœ‹ Allow panning (2 fingers on mobile)\n                                panSpeed={1.0} // Screen-space panning\n                                enableDamping={true}\n                                dampingFactor={0.05} // ğŸŒŠ Smooth inertia\n                                minDistance={20} // ğŸ›¡ï¸ Collision Avoidance (Solar Safety Zone)\n                                maxDistance={4000}\n                                autoRotate={!hasStarted}\n                                autoRotateSpeed={0.5}\n                                // ğŸ“± Mobile Optimization: Slower rotation for touch precision (0.5), faster for mouse (0.8)\n                                rotateSpeed={window.matchMedia(\"(pointer: coarse)\").matches ? 0.5 : 0.8}\n                                enabled={true}\n                            />\n                        </>\n                    ) : (\n                        /* ğŸ“± GYROSCOPE (MOTION) CONTROLS FOR AR */\n                        <DeviceOrientationControls />\n                    )}\n\n                    {/* ğŸ§¹ Memory Management & FPS Stability */}\n                    <PerformanceOptimizer />\n                    <SmartRenderingManager />\n\n                    {/* âœ¨ Post-Processing: Cinematic Bloom (Glow) */}\n                    <EffectComposer>\n                        <Bloom\n                            luminanceThreshold={0.2}\n                            mipmapBlur\n                            intensity={1.5}\n                            radius={0.6}\n                        />\n                    </EffectComposer>\n                </Canvas>\n            </ErrorBoundary>\n\n            {/* Main Menu Overlay (Cinematic Home) */}\n            {!hasStarted && (\n                <div className=\"absolute inset-0 z-50\">\n                    <CinematicHome onStart={() => setHasStarted(true)} />\n                </div>\n            )}\n\n            {/* UI Layer - Only Visible After Start */}\n            <div className={`transition-opacity duration-1000 ${hasStarted ? 'opacity-100' : 'opacity-0 pointer-events-none'}`}>\n                <NavigationSidebar onNavigate={handleNavigate} />\n\n                <div className=\"absolute top-safe left-0 p-4 md:p-8 text-white pointer-events-none transition-opacity duration-500 rtl:right-0 rtl:left-auto mt-12 md:mt-0\" style={{ marginTop: 'env(safe-area-inset-top)' }}>\n                    <h1 className=\"text-3xl md:text-5xl font-bold font-serif tracking-tighter bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-400\">\n                        {t('app.title')}\n                    </h1>\n                    <p className=\"text-base md:text-lg text-blue-200 mt-2 font-light\">{t('app.subtitle')}</p>\n                    <div className=\"mt-4 md:mt-8 text-sm text-gray-500 max-w-xs\">\n                        <p>{t('app.instruction')}</p>\n                    </div>\n                </div>\n\n                <TimeControls\n                    isPaused={isPaused}\n                    currentDate={currentDate}\n                    onPauseToggle={() => setIsPaused(!isPaused)}\n                />\n\n                <InfoPanel\n                    selectedObject={selectedObject}\n                    onClose={() => setSelectedObject(null)}\n                />\n\n                <div className=\"absolute bottom-safe left-1/2 -translate-x-1/2 text-white/30 text-xs font-serif pointer-events-none z-10 mb-2\">\n                    {t('app.credits')}\n                </div>\n\n                {/* ğŸµ Background Music */}\n                <audio id=\"bg-music\" loop>\n                    <source src={`${import.meta.env.BASE_URL}textures/interstellar.mp3`} type=\"audio/mpeg\" />\n                </audio>\n\n                <div className=\"absolute bottom-safe left-safe z-50 mb-4 ml-4 flex flex-row gap-[15px] items-end\">\n                    <button\n                        onClick={() => setIsARMode(!isARMode)}\n                        className={`p-3 rounded-full transition-all backdrop-blur-sm border border-white/10 ${isARMode ? 'bg-red-500/80 text-white' : 'bg-white/10 hover:bg-white/20 text-white/70 hover:text-white'}`}\n                        title=\"AR Mode\"\n                    >\n                        {/* Simple Icon for AR (Eye/Camera) */}\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z\" /><circle cx=\"12\" cy=\"12\" r=\"3\" /></svg>\n                    </button>\n\n                    <button\n                        onClick={() => setIsMarathonMode(!isMarathonMode)}\n                        className={`p-3 rounded-full transition-all backdrop-blur-sm border border-white/10 ${isMarathonMode ? 'bg-blue-500/80 text-white' : 'bg-white/10 hover:bg-white/20 text-white/70 hover:text-white'}`}\n                        title=\"Marathon Mode\"\n                    >\n                        {/* Icon: Alignment (Straight Line) */}\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                            <line x1=\"12\" y1=\"2\" x2=\"12\" y2=\"22\" strokeWidth=\"3\" />\n                            <circle cx=\"12\" cy=\"5\" r=\"2\" fill=\"currentColor\" />\n                            <circle cx=\"12\" cy=\"12\" r=\"2\" fill=\"currentColor\" />\n                            <circle cx=\"12\" cy=\"19\" r=\"2\" fill=\"currentColor\" />\n                        </svg>\n                    </button>\n\n                    {/* Vertical Stack: Robot on TOP of Music */}\n                    <div className=\"flex flex-col items-center gap-3\">\n                        {/* ğŸ¤– Gemini AI Assistant (Now embedded in layout) */}\n                        <GeminiChat />\n\n                        <button\n                            onClick={() => {\n                                const audio = document.getElementById('bg-music') as HTMLAudioElement;\n                                if (audio.paused) {\n                                    audio.volume = 0.4;\n                                    audio.play().catch(() => { });\n                                } else {\n                                    audio.pause();\n                                }\n                            }}\n                            className=\"p-3 bg-white/10 hover:bg-white/20 rounded-full text-white/70 hover:text-white transition-all backdrop-blur-sm border border-white/10\"\n                            title=\"Toggle Music\"\n                        >\n                            <Music className=\"w-5 h-5\" />\n                        </button>\n                    </div>\n                </div>\n\n                {/* Removed fixed GeminiChat from here */}\n\n                <Loader />\n            </div>\n        </div>\n    )\n}\n\nfunction App() {\n    return (\n        <Layout>\n            <ErrorBoundary>\n                <AppContent />\n            </ErrorBoundary>\n        </Layout>\n    )\n}\n\nexport default App\n","usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/AmbienceControl.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/AppEnhancements.tsx","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":86,"column":13,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":86,"endColumn":26,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[3374,3387],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":96,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":96,"endColumn":27},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":110,"column":9,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":110,"endColumn":22,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[4317,4330],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/no-unsafe-function-type","severity":2,"message":"The `Function` type accepts any function-like value.\nPrefer explicitly defining any function parameters and return type.","line":152,"column":33,"nodeType":"Identifier","messageId":"bannedFunctionType","endLine":152,"endColumn":41},{"ruleId":"react-hooks/unsupported-syntax","severity":1,"message":"Compilation Skipped: `this` is not supported syntax\n\nReact Compiler does not support compiling functions that use `this`.\n\n/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/AppEnhancements.tsx:154:30\n  152 |         function throttle(func: Function, limit = 100) {\n  153 |             let inThrottle: boolean;\n> 154 |             return function (this: any, ...args: any[]) {\n      |                              ^^^^^^^^^ `this` was used here\n  155 |                 if (!inThrottle) {\n  156 |                     func.apply(this, args);\n  157 |                     inThrottle = true;","line":154,"column":30,"nodeType":null,"endLine":154,"endColumn":39},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":154,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":154,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6003,6006],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6003,6006],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":154,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":154,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6017,6020],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6017,6020],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":243,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":243,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9101,9104],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9101,9104],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect } from 'react';\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// COMPREHENSIVE APP ENHANCEMENT SUITE\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// Integrated for React/Three.js Environment\n\nexport function AppEnhancements() {\n    useEffect(() => {\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n        // 1. ADVANCED FPS & ANIMATION OPTIMIZATION\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n        let lastFrameTime = 0;\n        const targetFPS = 60;\n        const frameDelay = 1000 / targetFPS;\n        let animationFrameId: number | null = null;\n\n        // Smooth animation with FPS limiting\n        function optimizedAnimationLoop(timestamp: number) {\n            if (timestamp - lastFrameTime >= frameDelay) {\n                // const delta = timestamp - lastFrameTime; // Unused in this shim\n                lastFrameTime = timestamp;\n\n                // Update all animations here\n                // Note: In R3F, planetary positions are handled by the Canvas loop. \n                // This external loop handles DOM-based animations if any.\n            }\n            animationFrameId = requestAnimationFrame(optimizedAnimationLoop);\n        }\n\n        function startAnimationLoop() {\n            if (!animationFrameId) {\n                animationFrameId = requestAnimationFrame(optimizedAnimationLoop);\n            }\n        }\n\n        // Stop when not visible (saves battery)\n        const handleVisibilityChange = () => {\n            if (document.hidden) {\n                if (animationFrameId) {\n                    cancelAnimationFrame(animationFrameId);\n                    animationFrameId = null;\n                }\n            } else {\n                startAnimationLoop();\n            }\n        };\n        document.addEventListener('visibilitychange', handleVisibilityChange);\n\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n        // 2. INTELLIGENT IMAGE LOADING & CACHING\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n        const imageCache = new Map();\n\n        // Lazy load images as needed\n        function lazyLoadImages() {\n            const images = document.querySelectorAll('img[data-src]');\n            const imageObserver = new IntersectionObserver((entries) => {\n                entries.forEach(entry => {\n                    if (entry.isIntersecting) {\n                        const img = entry.target as HTMLImageElement;\n                        img.src = img.dataset.src!;\n                        img.removeAttribute('data-src');\n                        imageObserver.unobserve(img);\n                    }\n                });\n            });\n\n            images.forEach(img => imageObserver.observe(img));\n        }\n\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n        // 3. MEMORY MANAGEMENT & CLEANUP\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n        function deepCleanup() {\n            // Clear unused image cache (keep only visible planets)\n            if (imageCache.size > 20) {\n                const entriesToDelete = Array.from(imageCache.keys()).slice(0, 10);\n                entriesToDelete.forEach(key => imageCache.delete(key));\n            }\n\n            // Force garbage collection if available\n            // @ts-ignore\n            if (window.gc) window.gc();\n\n            // Clear canvas buffers\n            // SAFEGUARD: Don't clear WebGL canvases\n            document.querySelectorAll('canvas').forEach(canvas => {\n                // Check if it's a 2D canvas before clearing\n                try {\n                    const ctx = canvas.getContext('2d');\n                    if (ctx) ctx.clearRect(0, 0, canvas.width, canvas.height);\n                } catch (e) {\n                    // WebGL contexts often throw or return null here, which is good (we skip them)\n                }\n            });\n        }\n\n        // Auto cleanup every minute\n        const cleanupInterval = setInterval(deepCleanup, 60000);\n\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n        // 4. ADAPTIVE QUALITY BASED ON DEVICE\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n        let deviceQuality = 'high';\n        // @ts-ignore\n        const deviceRAM = navigator.deviceMemory || 4;\n        const deviceCores = navigator.hardwareConcurrency || 4;\n\n        function detectDeviceCapability() {\n            const isMobile = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);\n            const isLowEnd = deviceRAM < 4 || deviceCores < 4;\n\n            if (isMobile && isLowEnd) {\n                deviceQuality = 'low';\n            } else if (isMobile || isLowEnd) {\n                deviceQuality = 'medium';\n            } else {\n                deviceQuality = 'high';\n            }\n\n            applyQualitySettings();\n        }\n\n        function applyQualitySettings() {\n            const root = document.documentElement;\n\n            switch (deviceQuality) {\n                case 'low':\n                    root.style.setProperty('--animation-duration', '2s');\n                    root.style.setProperty('--blur-amount', '2px');\n                    break;\n                case 'medium':\n                    root.style.setProperty('--animation-duration', '1.5s');\n                    root.style.setProperty('--blur-amount', '4px');\n                    break;\n                case 'high':\n                    root.style.setProperty('--animation-duration', '1s');\n                    root.style.setProperty('--blur-amount', '8px');\n                    break;\n            }\n        }\n\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n        // 5. DEBOUNCE & THROTTLE UTILITIES\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n        function throttle(func: Function, limit = 100) {\n            let inThrottle: boolean;\n            return function (this: any, ...args: any[]) {\n                if (!inThrottle) {\n                    func.apply(this, args);\n                    inThrottle = true;\n                    setTimeout(() => inThrottle = false, limit);\n                }\n            };\n        }\n\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n        // 6. SMOOTH PLANET GLOW EFFECT (CSS Injection)\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n        function addPlanetGlow() {\n            const style = document.createElement('style');\n            style.textContent = `\n        .planet {\n            filter: drop-shadow(0 0 10px currentColor);\n            transition: filter 0.3s ease, transform 0.3s ease;\n        }\n        \n        .planet:hover {\n            filter: drop-shadow(0 0 20px currentColor) brightness(1.2);\n            transform: scale(1.1);\n            cursor: pointer;\n        }\n        \n        .planet-glow {\n            animation: planetGlow 3s ease-in-out infinite;\n        }\n        \n        @keyframes planetGlow {\n            0%, 100% { filter: drop-shadow(0 0 10px currentColor); }\n            50% { filter: drop-shadow(0 0 25px currentColor); }\n        }\n    `;\n            document.head.appendChild(style);\n\n            // Apply to all planets\n            document.querySelectorAll('.planet, [class*=\"planet\"]').forEach(planet => {\n                planet.classList.add('planet-glow');\n            });\n        }\n\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n        // 7. ORBITAL TRAILS (CSS Injection)\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n        function createOrbitalTrails() {\n            const style = document.createElement('style');\n            style.textContent = `\n        .orbital-trail {\n            position: absolute;\n            border: 1px solid rgba(255, 255, 255, 0.2);\n            border-radius: 50%;\n            pointer-events: none;\n            animation: trailPulse 4s ease-in-out infinite;\n        }\n        \n        @keyframes trailPulse {\n            0%, 100% { opacity: 0.2; }\n            50% { opacity: 0.4; }\n        }\n    `;\n            document.head.appendChild(style);\n        }\n\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n        // 8. PARALLAX STARS BACKGROUND (2D Canvas)\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n        function createParallaxStars() {\n            const canvas = document.createElement('canvas');\n            canvas.id = 'parallax-stars';\n            canvas.style.position = 'fixed';\n            canvas.style.top = '0';\n            canvas.style.left = '0';\n            canvas.style.width = '100%';\n            canvas.style.height = '100%';\n            canvas.style.zIndex = '-1'; // Behind everything\n            canvas.style.pointerEvents = 'none';\n            document.body.prepend(canvas);\n\n            const ctx = canvas.getContext('2d');\n            if (!ctx) return;\n\n            canvas.width = window.innerWidth;\n            canvas.height = window.innerHeight;\n\n            const stars: any[] = [];\n            for (let i = 0; i < 200; i++) {\n                stars.push({\n                    x: Math.random() * canvas.width,\n                    y: Math.random() * canvas.height,\n                    radius: Math.random() * 1.5,\n                    speed: Math.random() * 0.3 + 0.1,\n                    opacity: Math.random() * 0.5 + 0.5\n                });\n            }\n\n            function animateStars() {\n                if (!ctx) return;\n                ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear screen for transparency\n\n                stars.forEach(star => {\n                    ctx.beginPath();\n                    ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);\n                    ctx.fillStyle = `rgba(255, 255, 255, ${star.opacity})`;\n                    ctx.fill();\n\n                    star.y += star.speed;\n                    if (star.y > canvas.height) star.y = 0;\n                });\n\n                requestAnimationFrame(animateStars);\n            }\n\n            animateStars();\n\n            window.addEventListener('resize', () => {\n                canvas.width = window.innerWidth;\n                canvas.height = window.innerHeight;\n            });\n        }\n\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n        // 9. SMOOTH ZOOM & PAN\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n        function enableSmoothZoom() {\n            // let scale = 1;\n            // Target the 3D Canvas container effectively\n            const container = document.querySelector('div[class*=\"bg-black\"]') as HTMLElement;\n\n            if (!container) return;\n\n            // container.style.transition = 'transform 0.3s ease-out'; // This might conflict with Canvas resize, careful.\n\n            const zoomHandler = throttle(() => {\n                // e.preventDefault(); // Don't block default scrolling entirely, R3F handles zoom usually\n                // This is a DOM-level zoom effect, likely not what we want for 3D, but adding as requested.\n                // We'll skip the transform scale on the CONTAINER because it blurs the canvas.\n                // Instead, we trust R3F controls.\n            }, 50);\n\n            container.addEventListener('wheel', zoomHandler, { passive: false });\n        }\n\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n        // 10. PLANET INFO TOOLTIPS (CSS + DOM)\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n        function createEnhancedTooltips() {\n            const style = document.createElement('style');\n            style.textContent = `\n        .planet-tooltip {\n            position: absolute;\n            background: rgba(0, 0, 20, 0.95);\n            color: white;\n            padding: 15px 20px;\n            border-radius: 12px;\n            border: 2px solid rgba(100, 150, 255, 0.5);\n            font-family: 'Segoe UI', Arial, sans-serif;\n            font-size: 14px;\n            pointer-events: none;\n            opacity: 0;\n            transform: translateY(10px);\n            transition: opacity 0.3s ease, transform 0.3s ease;\n            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);\n            z-index: 1000;\n            max-width: 250px;\n            backdrop-filter: blur(10px);\n        }\n        \n        .planet-tooltip.visible {\n            opacity: 1;\n            transform: translateY(0);\n        }\n        \n        .planet-tooltip h3 {\n            margin: 0 0 8px 0;\n            font-size: 18px;\n            color: #6cf;\n        }\n        \n        .planet-tooltip p {\n            margin: 4px 0;\n            line-height: 1.5;\n        }\n    `;\n            document.head.appendChild(style);\n\n            const tooltip = document.createElement('div');\n            tooltip.className = 'planet-tooltip';\n            document.body.appendChild(tooltip);\n\n            // Note: This targets DOM elements. Our planets are 3D. \n            // This will work if any 2D planet representations are added later.\n        }\n\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n        // 11. LOADING SCREEN WITH PROGRESS\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n        function createLoadingScreen() {\n            const loader = document.createElement('div');\n            loader.id = 'app-loader';\n            loader.innerHTML = `\n        <style>\n            #app-loader {\n                position: fixed;\n                top: 0;\n                left: 0;\n                width: 100%;\n                height: 100%;\n                background: linear-gradient(135deg, #000428 0%, #004e92 100%);\n                display: flex;\n                flex-direction: column;\n                justify-content: center;\n                align-items: center;\n                z-index: 10000;\n                transition: opacity 0.5s ease;\n            }\n            \n            #app-loader.hidden {\n                opacity: 0;\n                pointer-events: none;\n            }\n            \n            .loader-spinner {\n                width: 80px;\n                height: 80px;\n                border: 4px solid rgba(255, 255, 255, 0.1);\n                border-top: 4px solid #fff;\n                border-radius: 50%;\n                animation: spin 1s linear infinite;\n            }\n            \n            .loader-text {\n                color: white;\n                margin-top: 30px;\n                font-size: 20px;\n                font-family: 'Segoe UI', Arial, sans-serif;\n            }\n            \n            .loader-progress {\n                width: 300px;\n                height: 4px;\n                background: rgba(255, 255, 255, 0.2);\n                border-radius: 2px;\n                margin-top: 20px;\n                overflow: hidden;\n            }\n            \n            .loader-progress-bar {\n                height: 100%;\n                background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);\n                width: 0%;\n                transition: width 0.3s ease;\n            }\n            \n            @keyframes spin {\n                to { transform: rotate(360deg); }\n            }\n        </style>\n        <div class=\"loader-spinner\"></div>\n        <div class=\"loader-text\">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø±Ø­Ù„Ø© ÙÙŠ Ø§Ù„ÙƒÙˆÙ†...</div>\n        <div class=\"loader-progress\">\n            <div class=\"loader-progress-bar\"></div>\n        </div>\n    `;\n            document.body.prepend(loader);\n\n            // Simulate loading progress\n            let progress = 0;\n            const progressBar = loader.querySelector('.loader-progress-bar') as HTMLElement;\n            const interval = setInterval(() => {\n                progress += Math.random() * 30;\n                if (progress >= 100) {\n                    progress = 100;\n                    clearInterval(interval);\n                    setTimeout(() => {\n                        loader.classList.add('hidden');\n                        setTimeout(() => loader.remove(), 500);\n                    }, 300);\n                }\n                if (progressBar) progressBar.style.width = progress + '%';\n            }, 200);\n        }\n\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n        // MASTER INITIALIZATION FUNCTION\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n        function runEnhancements() {\n            try {\n                // Performance optimizations\n                detectDeviceCapability();\n                startAnimationLoop();\n                lazyLoadImages();\n\n                // Visual enhancements\n                addPlanetGlow();\n                createOrbitalTrails();\n                createParallaxStars();\n\n                // User experience\n                createEnhancedTooltips();\n                enableSmoothZoom();\n\n                // Loading Screen is handled in the main useEffect flow immediately on mount\n\n\n            } catch (error) {\n                console.error('âŒ Error loading enhancements:', error);\n            }\n        }\n\n        // Run Loading Screen Immediately\n        createLoadingScreen();\n\n        // Run other enhancements\n        runEnhancements();\n\n        // Cleanup function\n        return () => {\n            if (animationFrameId) cancelAnimationFrame(animationFrameId);\n            clearInterval(cleanupInterval);\n            document.removeEventListener('visibilitychange', handleVisibilityChange);\n            // Remove injected elements\n            document.getElementById('parallax-stars')?.remove();\n            document.getElementById('app-loader')?.remove();\n        };\n\n    }, []);\n\n    return null; // Headless component\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/AsteroidBelts.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/AuroraLayer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/AuroraVideoLayer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/CameraController.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`handleFocus` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/CameraController.tsx:73:13\n  71 |         flyTo: (objectId: string) => {\n  72 |             if (!controlsRef.current) return;\n> 73 |             handleFocus(objectId);\n     |             ^^^^^^^^^^^ `handleFocus` accessed before it is declared\n  74 |         }\n  75 |     }));\n  76 |\n\n/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/CameraController.tsx:84:5\n   82 |\n   83 |     // ğŸ¯ 3. SMOOTH GLIDE FOCUS LOGIC (OFFSET-BASED TRACKING)\n>  84 |     const handleFocus = (objectId: string) => {\n      |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n>  85 |         const targetObj = celestialObjects.find(o => o.id === objectId);\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n>  86 |         if (!targetObj || !controlsRef.current) return;\n      â€¦\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 143 |         timelineRef.current = tl;\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 144 |     };\n      | ^^^^^^^ `handleFocus` is declared here\n  145 |\n  146 |     // ğŸ›‘ 4. EXIT LOGIC\n  147 |     useEffect(() => {","line":73,"column":13,"nodeType":null,"endLine":73,"endColumn":24},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'controlsRef'. Either include it or remove the dependency array.","line":156,"column":8,"nodeType":"ArrayExpression","endLine":156,"endColumn":24,"suggestions":[{"desc":"Update the dependencies array to be: [controlsRef, selectedObject]","fix":{"range":[5478,5494],"text":"[controlsRef, selectedObject]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useFrame, useThree } from '@react-three/fiber'\nimport { useImperativeHandle, forwardRef, useEffect, useRef } from 'react'\nimport * as THREE from 'three'\nimport gsap from 'gsap'\nimport type { OrbitControls as OrbitControlsImpl } from 'three-stdlib'\nimport type { CelestialData } from '../types'\nimport { celestialObjects } from '../data/objects'\n\ninterface CameraControllerProps {\n    selectedObject: CelestialData | null;\n    objectPosition: THREE.Vector3 | null;\n    controlsRef: React.RefObject<OrbitControlsImpl>;\n    startIntro: boolean;\n}\n\nexport interface CameraControllerHandle {\n    flyTo: (objectId: string) => void;\n}\n\nexport const CameraController = forwardRef<CameraControllerHandle, CameraControllerProps>(({\n    selectedObject,\n    controlsRef,\n    startIntro\n}, ref) => {\n    const { camera } = useThree();\n    const timelineRef = useRef<gsap.core.Timeline | null>(null);\n    const hasIntroRun = useRef(false);\n\n    // ğŸ¬ 1. CINEMATIC INTRO ANIMATION (Fly-in)\n    useEffect(() => {\n        if (startIntro && !hasIntroRun.current && controlsRef.current) {\n            hasIntroRun.current = true;\n\n            // Clean prev animations\n            timelineRef.current?.kill();\n\n            // Set Initial State (Far away)\n            const startPos = new THREE.Vector3(0, 300, 600);\n            const targetPos = new THREE.Vector3(0, 40, 140); // Standard view\n\n            camera.position.copy(startPos);\n            controlsRef.current.target.set(0, 0, 0);\n            controlsRef.current.enabled = false; // Disable user control during intro\n\n            // Create Timeline\n            const tl = gsap.timeline({\n                onComplete: () => {\n                    if (controlsRef.current) {\n                        controlsRef.current.enabled = true;\n                    }\n                    // Immediate GC hint\n                    timelineRef.current = null;\n                }\n            });\n\n            // Fly-in Motion\n            tl.to(camera.position, {\n                x: targetPos.x,\n                y: targetPos.y,\n                z: targetPos.z,\n                duration: 3.5,\n                ease: \"power3.inOut\" // Cinematic ease\n            });\n\n            timelineRef.current = tl;\n        }\n    }, [startIntro, camera, controlsRef]);\n\n    // ğŸ”­ 2. EXPOSE public flyTo API for Sidebar\n    useImperativeHandle(ref, () => ({\n        flyTo: (objectId: string) => {\n            if (!controlsRef.current) return;\n            handleFocus(objectId);\n        }\n    }));\n\n    // ğŸ“Œ STATE: Track locking status\n    const lockedObjectId = useRef<string | null>(null);\n    const currentOffset = useRef(new THREE.Vector3());\n    const lastTargetPos = useRef<THREE.Vector3 | null>(null); // To track movement delta\n    const { scene } = useThree();\n\n    // ğŸ¯ 3. SMOOTH GLIDE FOCUS LOGIC (OFFSET-BASED TRACKING)\n    const handleFocus = (objectId: string) => {\n        const targetObj = celestialObjects.find(o => o.id === objectId);\n        if (!targetObj || !controlsRef.current) return;\n\n        // Clean prev\n        timelineRef.current?.kill();\n\n        // 1. Set Lock ID & Reset Delta Tracker\n        lockedObjectId.current = objectId;\n        lastTargetPos.current = null; // Will be set on first frame\n\n        // 2. Calculate Final Desired Offset (Cinematic Angle)\n        // Fixed Beauty Shot: (0.0, 0.4, 1.0) normalized\n        // We removed X offset to be centered, and increased Y (0.4) to look slightly down\n        // This prevents cutting through Saturn's rings (which are on X-Z plane).\n        const approachVector = new THREE.Vector3(0.0, 0.4, 1.0).normalize();\n        const finalDist = targetObj.science.scale * 6.0 + 25.0; // Safe distance\n        const finalOffset = approachVector.multiplyScalar(finalDist);\n\n        // 3. Initialize current offset\n        const sceneObj = scene.getObjectByName(objectId);\n        if (!sceneObj) return;\n\n        const targetPos = new THREE.Vector3();\n        sceneObj.getWorldPosition(targetPos);\n\n        // Initialize tracker\n        lastTargetPos.current = targetPos.clone();\n\n        // Calculate where we are relative to it NOW\n        currentOffset.current.subVectors(camera.position, targetPos);\n\n        // ğŸ›‘ Stop Rotation/Input\n        controlsRef.current.autoRotate = false;\n        controlsRef.current.enabled = false;\n\n        // Create Animation Timeline\n        const tl = gsap.timeline({\n            onComplete: () => {\n                if (controlsRef.current) {\n                    controlsRef.current.enabled = true;\n                    if (selectedObject?.id === objectId) {\n                        controlsRef.current.autoRotate = true;\n                        controlsRef.current.autoRotateSpeed = 2.0;\n                    }\n                    timelineRef.current = null;\n                }\n            }\n        });\n\n        // Animate the Offset Vector\n        tl.to(currentOffset.current, {\n            x: finalOffset.x,\n            y: finalOffset.y,\n            z: finalOffset.z,\n            duration: 2.5,\n            ease: \"power3.inOut\"\n        });\n\n        timelineRef.current = tl;\n    };\n\n    // ğŸ›‘ 4. EXIT LOGIC\n    useEffect(() => {\n        if (!selectedObject) {\n            if (controlsRef.current) controlsRef.current.autoRotate = false;\n            lockedObjectId.current = null;\n            lastTargetPos.current = null;\n        } else {\n            // Ensure lock is in sync\n            lockedObjectId.current = selectedObject.id;\n        }\n    }, [selectedObject]);\n\n    // ğŸ§¹ 5. DEEP CLEANUP\n    useEffect(() => {\n        return () => {\n            timelineRef.current?.kill();\n        }\n    }, []);\n\n    // ğŸ”„ 6. UPDATE LOOP (DELTA TRACKING) - PRIORITY 1000 (Run AFTER objects move)\n    useFrame(() => {\n        if (controlsRef.current && lockedObjectId.current) {\n            const sceneObj = scene.getObjectByName(lockedObjectId.current);\n            if (sceneObj) {\n                const targetPos = new THREE.Vector3();\n                sceneObj.getWorldPosition(targetPos);\n\n                // A. DELTA TRACKING: Move camera by the EXACT amount the object moved\n                if (lastTargetPos.current) {\n                    const delta = new THREE.Vector3().subVectors(targetPos, lastTargetPos.current);\n\n                    // Apply delta to camera (carry it along)\n                    camera.position.add(delta);\n\n                    // Update controls target to center\n                    controlsRef.current.target.copy(targetPos);\n                }\n\n                // If controls disabled (flying), we also need to apply the animation offset\n                if (!controlsRef.current.enabled) {\n                    // During flight, `camera.position` = `active target` + `animated offset`\n                    // We override the delta logic slightly here to ensure strictly smooth animation\n                    // Use force-set to prevent drift\n                    camera.position.copy(targetPos).add(currentOffset.current);\n                }\n\n                // Update last pos for next frame\n                if (!lastTargetPos.current) lastTargetPos.current = new THREE.Vector3();\n                lastTargetPos.current.copy(targetPos);\n            }\n        }\n\n        if (controlsRef.current) {\n            controlsRef.current.update();\n        }\n    }, 1000); // âš¡ PRIORITY HI: Runs after objects update to prevent 1-frame jitter\n\n    return null;\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/CameraIntro.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/CanvasAurora.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/CelestialObject.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'ringTexture' and 'surfaceTexture'. Either include them or remove the dependency array.","line":91,"column":8,"nodeType":"ArrayExpression","endLine":91,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [ringTexture, surfaceTexture]","fix":{"range":[2807,2809],"text":"[ringTexture, surfaceTexture]"}}]},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'react-hooks/immutability').","line":157,"column":9,"severity":1,"nodeType":null,"fix":{"range":[5083,5135],"text":" "}},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'cloudTexture' and 'dayTexture'. Either include them or remove the dependency array.","line":199,"column":8,"nodeType":"ArrayExpression","endLine":199,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [cloudTexture, dayTexture]","fix":{"range":[6461,6463],"text":"[cloudTexture, dayTexture]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'texture'. Either include it or remove the dependency array.","line":371,"column":8,"nodeType":"ArrayExpression","endLine":371,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [texture]","fix":{"range":[12291,12293],"text":"[texture]"}}]},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-unused-vars').","line":402,"column":5,"severity":1,"nodeType":null,"fix":{"range":[13173,13234],"text":" "}},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_err' is defined but never used.","line":441,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":441,"endColumn":18},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'texture'. Either include it or remove the dependency array.","line":450,"column":8,"nodeType":"ArrayExpression","endLine":450,"endColumn":27,"suggestions":[{"desc":"Update the dependencies array to be: [texturePath, name, texture]","fix":{"range":[14776,14795],"text":"[texturePath, name, texture]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_err' is defined but never used.","line":520,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":520,"endColumn":18},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'tailTexture'. Either include it or remove the dependency array.","line":528,"column":8,"nodeType":"ArrayExpression","endLine":528,"endColumn":14,"suggestions":[{"desc":"Update the dependencies array to be: [name, tailTexture]","fix":{"range":[17694,17700],"text":"[name, tailTexture]"}}]}],"suppressedMessages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: This value cannot be modified\n\nModifying a value returned from a hook is not allowed. Consider moving the modification into the hook where the value is constructed.\n\n/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/CelestialObject.tsx:156:9\n  154 |     useEffect(() => {\n  155 |         // eslint-disable-next-line react-hooks/immutability\n> 156 |         texture.wrapS = THREE.RepeatWrapping;\n      |         ^^^^^^^ `texture` cannot be modified\n  157 |         // eslint-disable-next-line react-hooks/immutability\n  158 |         texture.wrapT = THREE.RepeatWrapping;\n  159 |         return () => texture.dispose();","line":156,"column":9,"nodeType":null,"endLine":156,"endColumn":16,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":2,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":2,"source":"import { useRef, useState, useEffect } from 'react'\nimport { useFrame } from '@react-three/fiber'\nimport { useTexture } from '@react-three/drei'\nimport type { CelestialData } from '../types' // âœ¨ Refactored Import\nimport * as THREE from 'three';\nimport { getObjectPosition } from '../utils/astronomy'\nimport { textureLoadingManager } from '../utils/textureManager';\n\n// Helper for dynamic assets\n\n\ninterface CelestialObjectProps {\n    data: CelestialData\n    onSelect: (data: CelestialData) => void\n    dateRef: React.MutableRefObject<Date>\n    isSelected?: boolean\n    isMarathonMode?: boolean\n}\n\n\n\n\n// ğŸŒ Ø§Ù„ÙƒÙˆÙƒØ¨ Ø§Ù„Ø¹Ø§Ù… (Generic Planet Component)\n// ÙŠØ³ØªØ®Ø¯Ù… Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙƒÙˆØ§ÙƒØ¨ Ø§Ù„ØµØ®Ø±ÙŠØ© ÙˆØ§Ù„ØºØ§Ø²ÙŠØ© Ø§Ù„Ø¨Ø³ÙŠØ·Ø© Ù„ØªÙ‚Ù„ÙŠÙ„ ØªÙƒØ±Ø§Ø± Ø§Ù„ÙƒÙˆØ¯\ninterface GenericPlanetProps {\n    scale?: number;\n    texturePath: string;\n    rotationSpeed: number;\n    roughness?: number;\n    metalness?: number;\n    bumpMapPath?: string;\n    atmosphereColor?: string;\n    emissiveColor?: string;\n    emissiveIntensity?: number;\n}\n\nfunction GenericPlanet({\n    scale = 1.0,\n    texturePath,\n    rotationSpeed,\n    roughness = 0.3, // âœ¨ User Request: Glossy\n    metalness = 0.2, // âœ¨ User Request: Specular\n    emissiveColor = \"#FFFFFF\",\n    emissiveIntensity = 0.05,\n}: GenericPlanetProps) {\n    const texture = useTexture(`${import.meta.env.BASE_URL}${texturePath}`);\n    const meshRef = useRef<THREE.Mesh>(null);\n\n    // âœ… ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø°Ø§ÙƒØ±Ø© (Memory Cleanup)\n    useEffect(() => {\n        return () => texture.dispose();\n    }, [texture]);\n\n    useFrame((_, delta) => {\n        if (meshRef.current) {\n            meshRef.current.rotation.y += delta * rotationSpeed;\n        }\n    });\n\n    return (\n        <mesh ref={meshRef} scale={scale} castShadow={true} receiveShadow={true}>\n            <sphereGeometry args={[1, 64, 64]} />\n            <meshStandardMaterial\n                map={texture}\n                color=\"#FFFFFF\"\n                roughness={roughness}\n                metalness={metalness}\n                emissiveMap={texture}\n                emissive={emissiveColor}\n                emissiveIntensity={emissiveIntensity} // Ø¥Ø¶Ø§Ø¡Ø© Ø®Ø§ÙØªØ© Ø¬Ø¯Ø§Ù‹ Ù„Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù…Ø¸Ù„Ù…Ø© (Ø£Ùˆ Ù…Ø®ØµØµØ©)\n            />\n        </mesh>\n    );\n}\n\n// ğŸª ÙƒÙˆÙƒØ¨ Ø²Ø­Ù„ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ (Real Saturn)\n// ÙŠØªØ¶Ù…Ù† Ø§Ù„Ø­Ù„Ù‚Ø§Øª ÙˆØ§Ù„ÙƒÙˆÙƒØ¨ Ù…Ø¹Ø§Ù‹ ÙÙŠ Ù…Ø¬Ù…ÙˆØ¹Ø© ÙˆØ§Ø­Ø¯Ø©\nfunction RealSaturn({ scale = 1.0 }: { scale?: number }) {\n    const surfaceTexture = useTexture(`${import.meta.env.BASE_URL}textures/saturn_surface.png`);\n    const ringTexture = useTexture(`${import.meta.env.BASE_URL}textures/saturn_rings.png`);\n    const groupRef = useRef<THREE.Group>(null);\n    const planetRef = useRef<THREE.Mesh>(null);\n    const ringsRef = useRef<THREE.Mesh>(null);\n\n    // âœ… ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø°Ø§ÙƒØ±Ø©\n    useEffect(() => {\n        return () => {\n            surfaceTexture.dispose();\n            ringTexture.dispose();\n        };\n    }, []);\n\n    useFrame((_, delta) => {\n        // 1. Ø¯ÙˆØ±Ø§Ù† Ø§Ù„ÙƒÙˆÙƒØ¨ Ø­ÙˆÙ„ Ù†ÙØ³Ù‡ (Ø³Ø±ÙŠØ¹ Ø¬Ø¯Ø§Ù‹)\n        if (planetRef.current) {\n            planetRef.current.rotation.y += delta * 2.5;\n        }\n\n        // 2. Ø¯ÙˆØ±Ø§Ù† Ø§Ù„Ø­Ù„Ù‚Ø§Øª (Ø¨Ø·ÙŠØ¡ ÙˆÙ…Ø³ØªÙ‚Ù„)\n        if (ringsRef.current) {\n            ringsRef.current.rotation.z -= delta * 0.02;\n        }\n    });\n\n    return (\n        <group ref={groupRef}>\n            {/* Ø¬Ø³Ù… Ø§Ù„ÙƒÙˆÙƒØ¨ (Ù…ÙÙ„Ø·Ø­ Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„Ù‚Ø·Ø¨ÙŠÙ†) */}\n            <mesh\n                ref={planetRef}\n                scale={[scale * 1.1, scale * 0.9, scale * 1.1]}\n                castShadow={true}\n                receiveShadow={true}\n            >\n                <sphereGeometry args={[1, 64, 64]} />\n                <meshStandardMaterial\n                    map={surfaceTexture}\n                    color=\"#FFFFFF\"\n                    roughness={0.3} // âœ¨ Glossy\n                    metalness={0.2} // âœ¨ Specular\n                    emissiveMap={surfaceTexture}\n                    emissive=\"#C0A080\" // Warm Saturnian color\n                    emissiveIntensity={0.24} // Increased 20% (0.2 -> 0.24)\n                />\n            </mesh>\n            {/* Ø§Ù„Ø­Ù„Ù‚Ø§Øª */}\n            <mesh\n                ref={ringsRef}\n                rotation={[-Math.PI / 2, 0, 0]}\n                scale={scale}\n                receiveShadow={true}\n                castShadow={true}\n            >\n                <ringGeometry args={[1.4, 2.3, 128]} />\n                <meshStandardMaterial\n                    map={ringTexture}\n                    transparent={true}\n                    alphaMap={ringTexture}\n                    side={THREE.DoubleSide}\n                    depthWrite={false}\n                    opacity={0.95}\n                    color=\"#DDDDDD\"\n                    emissiveMap={ringTexture}\n                    emissive=\"#C0A080\"\n                    emissiveIntensity={0.36} // Increased 20% (0.3 -> 0.36)\n                />\n            </mesh>\n        </group>\n    );\n}\n// â˜€ï¸ Ø§Ù„Ø´Ù…Ø³ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© (Real Sun)\nfunction RealSun({ scale = 1.0 }: { scale?: number }) {\n    const texture = useTexture(`${import.meta.env.BASE_URL}textures/sun_surface.png`);\n\n    useEffect(() => {\n        // eslint-disable-next-line react-hooks/immutability\n        texture.wrapS = THREE.RepeatWrapping;\n        // eslint-disable-next-line react-hooks/immutability\n        texture.wrapT = THREE.RepeatWrapping;\n        return () => texture.dispose();\n    }, [texture]);\n\n    const meshRef = useRef<THREE.Mesh>(null);\n    useFrame((_, delta) => {\n        if (meshRef.current) {\n            meshRef.current.rotation.y += delta * 0.08;\n        }\n    });\n\n    return (\n        <mesh ref={meshRef} scale={scale} castShadow={false} receiveShadow={false}>\n            <sphereGeometry args={[5, 64, 64]} />\n            <meshStandardMaterial\n                map={texture}\n                color=\"#FFFFFF\"\n                roughness={0.2}\n                metalness={0.0}\n                emissiveMap={texture}\n                emissive=\"#FFDD00\"\n                emissiveIntensity={2.0}\n                toneMapped={false}\n            />\n        </mesh>\n    );\n}\n\n// ğŸŒ Ø§Ù„Ø£Ø±Ø¶ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© (Real Earth)\n// ØªØªØ·Ù„Ø¨ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø®Ø§ØµØ© Ù„Ù„ØºÙŠÙˆÙ… ÙˆØ§Ù„Ù†Ù‡Ø§Ø±\nfunction RealEarth({ scale = 1.0 }: { scale?: number }) {\n    const dayTexture = useTexture(`${import.meta.env.BASE_URL}textures/earth_daymap.png`);\n    const cloudTexture = useTexture(`${import.meta.env.BASE_URL}textures/earth_clouds.png`);\n    const earthRef = useRef<THREE.Group>(null);\n    const cloudsRef = useRef<THREE.Mesh>(null);\n\n    useEffect(() => {\n        return () => {\n            dayTexture.dispose();\n            cloudTexture.dispose();\n        };\n    }, []);\n\n    useFrame((_, delta) => {\n        if (earthRef.current) earthRef.current.rotation.y += delta * 0.15;\n        if (cloudsRef.current) cloudsRef.current.rotation.y += delta * 0.02;\n    });\n\n    return (\n        <group ref={earthRef}>\n            {/* Ø§Ù„Ø³Ø·Ø­ */}\n            <mesh scale={scale} castShadow={true} receiveShadow={true}>\n                <sphereGeometry args={[1, 64, 64]} />\n                <meshStandardMaterial\n                    map={dayTexture}\n                    color=\"#FFFFFF\"\n                    roughness={0.3} // âœ¨ Glossy\n                    metalness={0.2} // âœ¨ Specular\n                    emissiveMap={dayTexture}\n                    emissive=\"#112244\" // Atmosphere Reflection\n                    emissiveIntensity={0.18} // Increased 20% (0.15 -> 0.18)\n                />\n            </mesh>\n\n            {/* Ø§Ù„ØºÙŠÙˆÙ… */}\n            <mesh\n                ref={cloudsRef}\n                scale={scale * 1.01}\n                castShadow={true}\n                receiveShadow={true}\n            >\n                <sphereGeometry args={[1, 64, 64]} />\n                <meshStandardMaterial\n                    map={cloudTexture}\n                    transparent={true}\n                    opacity={0.9}\n                    side={THREE.DoubleSide}\n                    depthWrite={false}\n                    blending={THREE.NormalBlending}\n                />\n            </mesh>\n\n        </group>\n    );\n}\n\n// ğŸª Ø§Ù„Ù…Ø´ØªØ±ÙŠ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ (Real Jupiter) - 4K Upgrade\n// Storms, Great Red Spot, and proper Gas Giant PBR properties\n// ğŸª Ø§Ù„Ù…Ø´ØªØ±ÙŠ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ (Real Jupiter) - Robust Implementation\nfunction RealJupiter({ scale = 1.0 }: { scale?: number }) {\n    const [texture, setTexture] = useState<THREE.Texture | null>(null);\n\n    // Fallback if texture fails\n    const fallbackColor = \"#C88B3A\";\n\n    useEffect(() => {\n        const loader = new THREE.TextureLoader();\n        loader.load(\n            \"https://upload.wikimedia.org/wikipedia/commons/e/e2/Jupiter.jpg\",\n            (tex) => {\n                tex.anisotropy = 16;\n                tex.colorSpace = THREE.SRGBColorSpace;\n                setTexture(tex);\n            },\n            undefined,\n            (err) => console.error(\"Jupiter Texture Failed\", err)\n        );\n    }, []);\n\n    const meshRef = useRef<THREE.Mesh>(null);\n    useFrame((_, delta) => {\n        if (meshRef.current) meshRef.current.rotation.y += delta * 0.15;\n    });\n\n    return (\n        <mesh ref={meshRef} scale={scale} castShadow={true} receiveShadow={true}>\n            <sphereGeometry args={[1, 128, 128]} />\n            <meshStandardMaterial\n                map={texture}\n                color={texture ? \"#FFFFFF\" : fallbackColor} // Apply fallback color if no texture\n                roughness={0.3} // âœ¨ Glossy\n                metalness={0.2} // âœ¨ Specular\n                emissiveMap={texture || undefined}\n                emissive={fallbackColor} // Always emit base color\n                emissiveIntensity={0.12} // +20%\n                toneMapped={false}\n            />\n        </mesh>\n    );\n}\n\n// â„ï¸ Ø£ÙˆØ±Ø§Ù†ÙˆØ³ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ (Real Uranus) - 4K Upgrade\n// Hazy Cyan with correct Axis Tilt\n// â„ï¸ Ø£ÙˆØ±Ø§Ù†ÙˆØ³ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ (Real Uranus) - Robust Implementation\nfunction RealUranus({ scale = 1.0 }: { scale?: number }) {\n    const [texture, setTexture] = useState<THREE.Texture | null>(null);\n    const fallbackColor = \"#ACE5EE\";\n\n    useEffect(() => {\n        const loader = new THREE.TextureLoader();\n        loader.load(\n            \"https://upload.wikimedia.org/wikipedia/commons/3/3d/Uranus2.jpg\",\n            (tex) => {\n                tex.anisotropy = 16;\n                tex.colorSpace = THREE.SRGBColorSpace;\n                setTexture(tex);\n            },\n            undefined,\n            (err) => console.error(\"Uranus Texture Failed\", err)\n        );\n    }, []);\n\n    const meshRef = useRef<THREE.Mesh>(null);\n    useFrame((_, delta) => {\n        if (meshRef.current) meshRef.current.rotation.z += delta * 0.15;\n    });\n\n    return (\n        <mesh\n            ref={meshRef}\n            scale={scale}\n            castShadow={true}\n            receiveShadow={true}\n            rotation={[Math.PI / 2 + 0.14, 0, 0]}\n        >\n            <sphereGeometry args={[1, 64, 64]} />\n            <meshStandardMaterial\n                map={texture}\n                color={texture ? \"#FFFFFF\" : fallbackColor}\n                roughness={0.3} // âœ¨ Glossy\n                metalness={0.2} // âœ¨ Specular\n                emissiveMap={texture || undefined}\n                emissive={fallbackColor}\n                emissiveIntensity={0.18} // +20%\n            />\n        </mesh>\n    );\n}\n\n// ğŸ’« Ø§Ù„Ø·Ø§Ø±Ù‚ (Real Al-Tariq - Sprite)\nfunction RealAlTariq({ scale = 1.0 }: { scale?: number }) {\n    const texture = useTexture(`${import.meta.env.BASE_URL}textures/al_tariq_real.png`);\n    return (\n        <group>\n            <sprite scale={[scale * 15, scale * 15, 1]}>\n                <spriteMaterial\n                    map={texture}\n                    toneMapped={false}\n                    depthWrite={false}\n                    blending={THREE.AdditiveBlending}\n                    color=\"#FFFFFF\"\n                />\n            </sprite>\n            <sprite scale={[scale * 25, scale * 25, 1]}>\n                <spriteMaterial\n                    map={texture}\n                    toneMapped={false}\n                    depthWrite={false}\n                    blending={THREE.AdditiveBlending}\n                    opacity={0.3}\n                    color=\"#00FFFF\"\n                />\n            </sprite>\n        </group>\n    );\n}\n\n// ğŸŒŸ Ù†Ø¬Ù… Ø§Ù„Ø¬Ø¨Ø§Ø± (Real Orion Star)\nfunction RealOrionStar({ scale = 1.0 }: { scale?: number }) {\n    const texture = useTexture(`${import.meta.env.BASE_URL}textures/blue_supergiant_surface.png`);\n\n    useEffect(() => {\n        return () => texture.dispose();\n    }, []);\n\n    const meshRef = useRef<THREE.Mesh>(null);\n    useFrame((_, delta) => {\n        if (meshRef.current) meshRef.current.rotation.y += delta * 0.05;\n    });\n\n    return (\n        <mesh ref={meshRef} scale={scale} castShadow={false} receiveShadow={false}>\n            <sphereGeometry args={[1, 64, 64]} />\n            <meshStandardMaterial\n                map={texture}\n                color=\"#FFFFFF\"\n                roughness={0.2}\n                metalness={0.1}\n                emissiveMap={texture}\n                emissive=\"#FFFFFF\"\n                emissiveIntensity={2.0}\n                toneMapped={false}\n            />\n        </mesh>\n    );\n}\n\n// ğŸª¨ ÙƒÙˆÙŠÙƒØ¨ Ø¹Ø§Ù… (Generic Asteroid) - Low Poly\n// ğŸª¨ ÙƒÙˆÙŠÙƒØ¨ Ø¹Ø§Ù… (Generic Asteroid) - Final Authentic Version\nfunction GenericAsteroid({\n    scale = 1.0,\n    texturePath,\n    color = \"#FFFFFF\",\n    dimensions = [1, 1, 1],\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    name\n}: {\n    scale?: number,\n    texturePath: string,\n    color?: string,\n    dimensions?: [number, number, number],\n    name: string\n}) {\n    // ğŸ” Texture Injection System\n    const [texture, setTexture] = useState<THREE.Texture | null>(null);\n\n    // ğŸ¨ Matte Mode Tint\n    // We tint pure white (#FFFFFF) to Light Grey (#BBBBBB) to prevent sunlight overexposure.\n    // This acts like a \"Moon Filter\".\n    const displayColor = color === '#FFFFFF' ? '#BBBBBB' : color;\n\n    useEffect(() => {\n        // ğŸ”„ Use Shared Manager\n        const loader = new THREE.TextureLoader(textureLoadingManager);\n\n        const cleanPath = texturePath.startsWith('/') ? texturePath.slice(1) : texturePath;\n        const fullPath = `${import.meta.env.BASE_URL}${cleanPath}?v=final`;\n\n        loader.load(\n            fullPath,\n            (tex) => {\n                tex.colorSpace = THREE.SRGBColorSpace;\n\n                // ğŸ”„ TEXTURE TILING (The Pro Camera Script)\n                // Since asteroids are huge now (2x), we tile the texture 2x to keep details sharp\n                tex.wrapS = THREE.RepeatWrapping;\n                tex.wrapT = THREE.RepeatWrapping;\n                tex.repeat.set(2, 2);\n                tex.needsUpdate = true;\n\n                setTexture(tex);\n            },\n            undefined,\n            (_err) => { /* Silenced error */ }\n        );\n\n        // ğŸ§¹ MEMORY DISPOSAL: Clean up texture on unmount\n        return () => {\n            if (texture) {\n                texture.dispose();\n            }\n        };\n    }, [texturePath, name]);\n\n    const meshRef = useRef<THREE.Mesh>(null);\n\n    useFrame((_, delta) => {\n        if (meshRef.current) {\n            meshRef.current.rotation.y += delta * 0.2;\n            meshRef.current.rotation.x += delta * 0.1;\n        }\n    });\n\n    return (\n        <group>\n            {/* ğŸ’¡ CINEMATIC LIGHTING (The Pro Camera Script) */}\n            {/* Strong searchlight to reveal surface details */}\n            <pointLight color=\"#a3ccf5\" intensity={2.0} distance={40} decay={2} />\n\n            <mesh ref={meshRef} scale={[scale * dimensions[0], scale * dimensions[1], scale * dimensions[2]]} castShadow={true} receiveShadow={true}>\n                {/* ğŸŒ High-Res Sphere for Displacement Mapping (The Pro Camera Fix) */}\n                {/* Increased segments to 64x64 for smooth wrapping of tiled texture */}\n                <sphereGeometry args={[1, 64, 64]} />\n                <meshStandardMaterial\n                    map={texture || undefined}\n\n                    // ğŸ”ï¸ SHAPE: Displacement Map physically deforms the sphere based on the texture\n                    displacementMap={texture || undefined}\n                    displacementScale={texture ? 0.08 : 0}\n\n                    // ğŸŒ‘ DETAIL: Bump Map for fine surface noise\n                    bumpMap={texture || undefined}\n                    bumpScale={0.02}\n\n                    // ğŸ’¡ VISIBILITY: Matte Mode (Moon-like)\n                    // Low emissive allows shadows to exist.\n                    emissiveMap={texture || undefined}\n                    emissive=\"#222222\" // ğŸŒ‘ Deep Dark Glow (Just enough to prevent black crush)\n                    emissiveIntensity={texture ? 0.1 : 0.0} // âš–ï¸ Minimal glow to restore contrast\n\n                    color={displayColor} // ğŸ¨ Applied Color (Grey Tint #BBBBBB to prevent whiteout)\n                    roughness={0.9} // ğŸ§± High Roughness (Matte/Chalky) to stop shiny glare\n                    metalness={0.0} // â¬‡ï¸ Zero metalness (Dry Rock)\n                    flatShading={false}\n                />\n            </mesh>\n        </group>\n    );\n}\n\n// â˜„ï¸ Ù…Ø°Ù†Ø¨ Ù‡Ø§Ù„ÙŠ (Halley's Comet)\nfunction HalleyComet({\n    scale = 1.0,\n    // dimensions, glowIntensity, texturePath removed\n    name\n}: {\n    scale?: number,\n    name: string\n}) {\n    // ğŸ” Texture Injection & Verification System\n    const [tailTexture, setTailTexture] = useState<THREE.Texture | null>(null);\n\n    useEffect(() => {\n        const loader = new THREE.TextureLoader(textureLoadingManager);\n\n        // Surface loader removed (unused)\n\n        // 2. Load Tail\n        loader.load(\n            `${import.meta.env.BASE_URL}textures/shooting_star_trail.png`,\n            (tex) => setTailTexture(tex),\n            undefined,\n            (_err) => { /* Silenced error */ }\n        );\n\n        // Coma loader removed (unused)\n\n        return () => {\n            if (tailTexture) tailTexture.dispose();\n        };\n    }, [name]);\n\n\n    const meshRef = useRef<THREE.Mesh>(null);\n\n    useFrame((_, delta) => {\n        if (meshRef.current) {\n            meshRef.current.rotation.y += delta * 0.1;\n        }\n    });\n\n    return (\n        <group>\n            {/* â˜„ï¸ User Request: Removed Nucleus and Coma (Head) due to distortion. Only Tail remains. */}\n\n            {/* Tail - Rendered as a fixed Plane (Mesh) instead of Sprite to prevent camera rotation */}\n            {/* Tail - Rendered as a Volumetric Cone to eliminate \"overlapping planes\" artifacts */}\n            {tailTexture && (\n                <mesh\n                    position={[scale * 10, 0, 0]}\n                    rotation={[0, 0, -Math.PI / 2]} // Pointing trailing direction\n                    renderOrder={-2}\n                >\n                    {/* RadiusTop: 0.5, RadiusBottom: 6 (Flare out), Height: 25 */}\n                    <cylinderGeometry args={[0.5 * scale, 6 * scale, scale * 25, 32, 1, true]} />\n                    <meshBasicMaterial\n                        map={tailTexture}\n                        color=\"#AADDFF\" // Slight blue tint for ice feel\n                        opacity={0.3} // Lower opacity for soft \"gas\" look\n                        transparent={true}\n                        blending={THREE.AdditiveBlending}\n                        depthWrite={false}\n                        side={THREE.DoubleSide}\n                    />\n                </mesh>\n            )}\n        </group>\n    );\n}\n\n\n\nexport function CelestialObject(props: CelestialObjectProps) {\n    const { data, onSelect, dateRef, isSelected } = props;\n    const meshRef = useRef<THREE.Mesh>(null)\n    const groupRef = useRef<THREE.Group>(null)\n\n    const [hovered, setHover] = useState(false)\n    // Removed legacy textures state and effect\n\n    const baseScale = data.science.scale;\n    const targetScale = hovered || isSelected ? baseScale * 1.1 : baseScale;\n\n    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ§Ù„Ø¯ÙˆØ±Ø§Ù†\n    useFrame((state, delta) => {\n        if (groupRef.current && dateRef.current) {\n            // Pass marathon mode flag\n            const newPos = getObjectPosition(data.id, dateRef.current, props.isMarathonMode);\n            groupRef.current.position.set(newPos[0], newPos[1], newPos[2]);\n\n            // âš¡ Frustum Culling: Hide objects if too far\n            const distance = state.camera.position.distanceTo(groupRef.current.position);\n            const isCritical = ['sun', 'al-tariq', 'sirius'].includes(data.id); // âš ï¸ Constraint: Do not cull these\n\n            if (!isCritical) {\n                if (distance > 50000) { // âœ¨ Extended Range (was 2000)\n                    groupRef.current.visible = false;\n                } else {\n                    groupRef.current.visible = true;\n                }\n            }\n        }\n\n        if (meshRef.current) {\n            const rotateSpeed = 0.2;\n            const finalScale = targetScale;\n            meshRef.current.rotation.y += delta * rotateSpeed;\n            meshRef.current.scale.lerp(new THREE.Vector3(finalScale, finalScale, finalScale), 10 * delta);\n        }\n    })\n\n    const initialPos = new THREE.Vector3(...data.initialPosition);\n\n    // ğŸ”§ Special Scale Overrides (Fixing Sirius & Small Objects)\n    let hitboxScale = targetScale * 1.25;\n    if (['mercury', 'moon', 'pluto'].includes(data.id)) hitboxScale = targetScale * 1.5;\n    if (data.id === 'sirius') hitboxScale = 120; // ğŸŒŸ Override for Sirius (Visual is 100, so 120 is tight)\n\n    let ringInner = baseScale * 1.5;\n    let ringOuter = baseScale * 1.52;\n    if (data.id === 'sirius') {\n        hitboxScale = 2; // ğŸ¯ FINAL: Absolute minimum (diameter 4) - requires precise click\n        ringInner = 200;\n        ringOuter = 202;\n    }\n\n    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n    // RENDER: Main Celestial Group\n    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n    return (\n        <group\n            ref={groupRef}\n            name={data.id} // Essential for CameraController to find it\n            position={initialPos}\n            onPointerOver={(e) => {\n                if (data.id === 'sirius') return; // ğŸ›‘ HARD RESET: Disable Group Hover for Sirius\n                e.stopPropagation();\n                setHover(true);\n                document.body.style.cursor = 'pointer';\n            }}\n            onPointerOut={() => {\n                if (data.id === 'sirius') return; // ğŸ›‘ HARD RESET: Disable Group Hover for Sirius\n                setHover(false);\n                document.body.style.cursor = 'auto';\n            }}\n            onClick={(e) => {\n                if (data.id === 'sirius') return; // ğŸ›‘ HARD RESET: Disable Group Click for Sirius\n                e.stopPropagation();\n                onSelect(data);\n            }}\n        >\n            {/* ğŸ¯ UNIVERSAL INTERACTION HITBOX (The padding/margin of error) */}\n            {/* This invisible sphere is slightly larger than the visual object to capture clicks easily */}\n            {/* It acts as the primary raycast target to solve \"layer/cloud\" blocking issues */}\n            <mesh\n                ref={meshRef}\n                name={`${data.id}-hitbox`}\n                // Scale is slightly larger (1.3x) for easier tapping on mobile\n                // For small objects (Moon, Mercury, Pluto), we grant even generous padding\n                scale={hitboxScale} // âœ… Uses correct scale logic\n                onClick={(e) => {\n                    if (data.id === 'sirius') return; // ğŸš« DISABLED: No interaction\n                    e.stopPropagation()\n                    onSelect(data)\n                }}\n                onPointerOver={() => {\n                    if (data.id === 'sirius') return; // ğŸš« DISABLED: No interaction\n                    document.body.style.cursor = 'pointer'\n                    setHover(true)\n                }}\n                onPointerOut={() => {\n                    if (data.id === 'sirius') return; // ğŸš« DISABLED: No interaction\n                    document.body.style.cursor = 'auto'\n                    setHover(false)\n                }}\n                visible={data.id === 'sirius' ? false : true} // ğŸš« DISABLED: Invisible to raycaster\n            >\n                <sphereGeometry args={[1, 16, 16]} />\n                <meshBasicMaterial\n                    transparent={true}\n                    opacity={0.0} // Invisible\n                    depthWrite={false}\n                    depthTest={data.id === 'sirius' ? true : false} // â˜¢ï¸ NUCLEAR: Enable depth for Sirius\n                    color=\"pink\" // Debug color (invisible via opacity)\n                    side={THREE.DoubleSide}\n                />\n            </mesh>\n\n            {/* Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¬Ø³Ù…Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹ (Rendering Logic) */}\n\n            {/* 1. Ø²Ø­Ù„ (Saturn) */}\n            {data.id === 'saturn' && (\n                <group><RealSaturn scale={targetScale} /></group>\n            )}\n\n            {/* 2. Ø§Ù„Ù…Ø´ØªØ±ÙŠ (Jupiter) - 4K Real Texture */}\n            {data.id === 'jupiter' && (\n                <group><RealJupiter scale={targetScale} /></group>\n            )}\n\n            {/* 3. Ø§Ù„Ø£Ø±Ø¶ (Earth) */}\n            {data.id === 'earth' && (\n                <group><RealEarth scale={targetScale} /></group>\n            )}\n\n            {/* 4. Ø§Ù„Ø´Ù…Ø³ (Sun) */}\n            {data.id === 'sun' && (\n                <>\n                    <pointLight\n                        intensity={2.0}\n                        distance={10000}\n                        decay={0.5}\n                        color=\"#FFF4E6\"\n                        castShadow={true}\n                        shadow-bias={-0.0001}\n                        shadow-mapSize-width={2048}\n                        shadow-mapSize-height={2048}\n                    />\n                    <group><RealSun scale={targetScale} /></group>\n                </>\n            )}\n\n            {/* 5. Ø£ÙˆØ±Ø§Ù†ÙˆØ³ (Uranus) - Ø®Ø§Øµ Ø¨Ø³Ø¨Ø¨ Ø§Ù„Ù…ÙŠÙ„Ø§Ù† */}\n            {data.id === 'uranus' && (\n                <group><RealUranus scale={targetScale} /></group>\n            )}\n\n            {/* 6. Ù†Ø¬ÙˆÙ… Ø§Ù„Ø­Ø²Ø§Ù… (Orion's Belt) */}\n            {['alnitak', 'alnilam', 'mintaka'].includes(data.id) && (\n                <group>\n                    <pointLight intensity={1.5} distance={500} decay={2.0} color=\"#4488ff\" />\n                    <RealOrionStar scale={targetScale} />\n                </group>\n            )}\n\n            {/* 7. Ø§Ù„Ø·Ø§Ø±Ù‚ (Al-Tariq) */}\n            {data.id === 'al-tariq' && (\n                <group>\n                    <pointLight intensity={100.0} distance={6000} decay={1.5} color=\"#00FFFF\" />\n                    <RealAlTariq scale={targetScale} />\n                </group>\n            )}\n\n            {/* 8. Ø§Ù„Ø´Ø¹Ø±Ù‰ (Sirius) - Sprite */}\n            {data.id === 'sirius' && <SiriusSprite scale={data.science.scale} />}\n\n            {/* 9. Ø§Ù„ÙƒÙˆØ§ÙƒØ¨ Ø§Ù„Ø¹Ø§Ù…Ø© (Generic Planets) - Ø¯Ù…Ø¬ Ø§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ù…ØªÙƒØ±Ø± */}\n            {data.id === 'mars' && (\n                <GenericPlanet\n                    scale={targetScale}\n                    texturePath=\"textures/mars_surface.png\"\n                    rotationSpeed={0.12}\n                    roughness={0.8}\n                    metalness={0.05}\n                    emissiveColor=\"#C05030\" // Reddish glow for Mars\n                    emissiveIntensity={0.24} // Increased 20% (0.2 -> 0.24)\n                />\n            )}\n            {data.id === 'venus' && (\n                <GenericPlanet\n                    scale={targetScale}\n                    texturePath=\"textures/venus_atmosphere.png\"\n                    rotationSpeed={0.05}\n                    roughness={1.0}\n                    metalness={0.0}\n                    emissiveColor=\"#E6C288\"\n                    emissiveIntensity={0.18} // +20%\n                />\n            )}\n            {data.id === 'mercury' && (\n                <GenericPlanet\n                    scale={targetScale}\n                    texturePath=\"textures/mercury_surface.png\"\n                    rotationSpeed={0.05}\n                    roughness={0.9}\n                    metalness={0.1}\n                    emissiveColor=\"#A0A0A0\"\n                    emissiveIntensity={0.18} // +20%\n                />\n            )}\n            {data.id === 'neptune' && (\n                <GenericPlanet\n                    scale={targetScale}\n                    texturePath=\"textures/neptune_surface.png\"\n                    rotationSpeed={0.12}\n                    roughness={0.4}\n                    metalness={0.1}\n                    emissiveColor=\"#4b70dd\"\n                    emissiveIntensity={0.18} // +20%\n                />\n            )}\n            {data.id === 'pluto' && (\n                <GenericPlanet\n                    scale={targetScale}\n                    texturePath=\"textures/pluto_surface.png\"\n                    rotationSpeed={0.02}\n                    roughness={0.8}\n                    metalness={0.05}\n                    emissiveColor=\"#D0D0D0\"\n                    emissiveIntensity={0.18} // +20%\n                />\n            )}\n            {data.id === 'moon' && (\n                <GenericPlanet\n                    scale={targetScale}\n                    texturePath=\"textures/moon_surface.png\"\n                    rotationSpeed={0.05}\n                    roughness={0.9}\n                    metalness={0.05}\n                    emissiveColor=\"#BBBBBB\"\n                    emissiveIntensity={0.18} // +20%\n                />\n            )}\n\n\n            {/* 10. Ø§Ù„ØµØ®ÙˆØ± Ø§Ù„ÙØ¶Ø§Ø¦ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© (New Space Rocks) */}\n            {data.id === 'halley' && (\n                <HalleyComet\n                    scale={targetScale}\n                    name={data.id} // âœ¨ Pass name for logging\n                />\n            )}\n\n            {/* Asteroids - Mapping IDs to Textures */}\n            {['ceres', 'vesta', 'pallas', 'juno', 'eros', 'ida', 'gaspra', 'bennu', 'ryugu'].includes(data.id) && (\n                <GenericAsteroid\n                    scale={targetScale}\n                    texturePath={data.science.texture || `textures/${data.id}_surface.png`}\n                    color={data.science.color} // âœ¨ User Request: Full True Color via Data\n                    dimensions={data.science.shapeScale}\n                    name={data.id} // âœ¨ For Logging\n                />\n            )}\n\n            {/* 11. Ø­Ù„Ù‚Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ¯ (Selection Ring) */}\n            {(hovered || isSelected) && (\n                <mesh rotation={[-Math.PI / 2, 0, 0]} raycast={() => null}>\n                    <ringGeometry args={[ringInner, ringOuter, 64]} />\n                    <meshBasicMaterial color=\"#4facfe\" side={THREE.DoubleSide} toneMapped={false} />\n                </mesh>\n            )}\n        </group>\n    );\n}\n// ğŸŒŸ Ù†Ø¬Ù… Ø§Ù„Ø´Ø¹Ø±Ù‰ (Sirius Sprite Component)\nfunction SiriusSprite({ scale }: { scale: number }) {\n    const texture = useTexture(`${import.meta.env.BASE_URL}textures/sirius_real.png`);\n    return (\n        <group>\n            <pointLight intensity={250.0} distance={8000} decay={1.0} color=\"#dceeff\" />\n            <sprite scale={[scale, scale, 1]} raycast={() => null}>\n                <spriteMaterial\n                    map={texture}\n                    color=\"#FFFFFF\"\n                    blending={THREE.AdditiveBlending}\n                    depthWrite={false}\n                    toneMapped={false}\n                />\n            </sprite>\n        </group>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/CinematicHome.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/ContentDisclaimer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/ErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/GeminiChat.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":63,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2395,2398],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2395,2398],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Sparkles, X, Send, Bot, MessageSquare, Loader2 } from 'lucide-react';\n\ninterface Message {\n    role: 'user' | 'model';\n    text: string;\n}\n\nexport function GeminiChat() {\n    const { t, i18n } = useTranslation();\n    const [isOpen, setIsOpen] = useState(false);\n    const [messages, setMessages] = useState<Message[]>([]);\n    const [input, setInput] = useState('');\n    const [isLoading, setIsLoading] = useState(false);\n    const messagesEndRef = useRef<HTMLDivElement>(null);\n    const isRTL = i18n.language === 'ar';\n\n    // Auto-scroll to bottom\n    const scrollToBottom = () => {\n        messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n    };\n\n    useEffect(() => {\n        scrollToBottom();\n    }, [messages, isOpen]);\n\n    const handleSend = async () => {\n        if (!input.trim()) return;\n\n        const userMsg = input;\n        setInput('');\n        setMessages(prev => [...prev, { role: 'user', text: userMsg }]);\n        setIsLoading(true);\n\n        try {\n            const apiKey = import.meta.env.VITE_GEMINI_API_KEY;\n            const MODEL_NAME = \"gemini-2.5-flash\";\n            const API_VERSION = \"v1beta\";\n            const FULL_MODEL_PATH = `${API_VERSION}/models/${MODEL_NAME}`;\n\n            const response = await fetch(\n                `https://generativelanguage.googleapis.com/${FULL_MODEL_PATH}:generateContent?key=${apiKey}`,\n                {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({ contents: [{ parts: [{ text: userMsg }] }] })\n                }\n            );\n\n            const data = await response.json();\n\n            if (!response.ok || data.error) {\n                // ... (Error handling remains same, kept concise for replace)\n                const originalError = data.error?.message || `HTTP ${response.status}`;\n                console.warn(\"Primary model failed.\", originalError);\n                throw new Error(originalError);\n            }\n\n            const aiText = data.candidates?.[0]?.content?.parts?.[0]?.text || \"Sorry, I couldn't understand that.\";\n            setMessages(prev => [...prev, { role: 'model', text: aiText }]);\n        } catch (error: any) {\n            console.error(\"Gemini Catch Block:\", error);\n            setMessages(prev => [...prev, { role: 'model', text: `System Error: ${error.message}` }]);\n        } finally {\n            setIsLoading(false);\n        }\n    };\n\n    return (\n        <div className=\"relative z-50 flex flex-col items-center pointer-events-auto\">\n\n            <AnimatePresence>\n                {isOpen && (\n                    <motion.div\n                        initial={{ opacity: 0, scale: 0.9, y: 20 }}\n                        animate={{ opacity: 1, scale: 1, y: 0 }}\n                        exit={{ opacity: 0, scale: 0.9, y: 20 }}\n                        className=\"mb-4 w-80 md:w-96 bg-black/80 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl overflow-hidden flex flex-col\"\n                        style={{ height: '500px' }}\n                        dir={isRTL ? 'rtl' : 'ltr'}\n                    >\n                        {/* Header */}\n                        <div className=\"p-4 bg-white/5 border-b border-white/10 flex justify-between items-center\">\n                            <div className=\"flex items-center gap-2\">\n                                <Sparkles className=\"w-5 h-5 text-yellow-400\" />\n                                <h3 className=\"text-white font-serif font-bold\">{t('Gemini Assistant') || 'Gemini Assistant'}</h3>\n                            </div>\n                            <button\n                                onClick={() => setIsOpen(false)}\n                                className=\"text-gray-400 hover:text-white transition-colors\"\n                            >\n                                <X className=\"w-5 h-5\" />\n                            </button>\n                        </div>\n\n                        {/* Messages */}\n                        <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\n                            {messages.length === 0 && (\n                                <div className=\"text-center text-gray-500 mt-10 flex flex-col items-center\">\n                                    <MessageSquare className=\"w-8 h-8 mb-2 opacity-50\" />\n                                    <p className=\"text-sm\">{t('Ask me anything about space!') || \"Ask me anything about space!\"}</p>\n                                </div>\n                            )}\n\n                            {messages.map((msg, idx) => (\n                                <div\n                                    key={idx}\n                                    className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}\n                                >\n                                    <div\n                                        className={`max-w-[80%] p-3 rounded-2xl text-sm leading-relaxed ${msg.role === 'user'\n                                            ? 'bg-blue-600 text-white rounded-tr-sm'\n                                            : 'bg-white/10 text-gray-200 rounded-tl-sm'\n                                            }`}\n                                    >\n                                        {msg.text}\n                                    </div>\n                                </div>\n                            ))}\n\n                            {isLoading && (\n                                <div className=\"flex justify-start\">\n                                    <div className=\"bg-white/10 p-3 rounded-2xl rounded-tl-sm flex gap-1 items-center\">\n                                        <Loader2 className=\"w-4 h-4 animate-spin text-gray-400\" />\n                                    </div>\n                                </div>\n                            )}\n                            <div ref={messagesEndRef} />\n                        </div>\n\n                        {/* Input */}\n                        <div className=\"p-4 bg-white/5 border-t border-white/10\">\n                            <form\n                                className=\"flex gap-2\"\n                                onSubmit={(e) => {\n                                    e.preventDefault();\n                                    handleSend();\n                                }}\n                            >\n                                <input\n                                    type=\"text\"\n                                    value={input}\n                                    onChange={(e) => setInput(e.target.value)}\n                                    placeholder={t('Type your question...') || \"Type your question...\"}\n                                    className={`flex-1 bg-black/50 border border-white/10 rounded-xl px-4 py-2 text-white text-sm focus:outline-none focus:border-blue-500/50 transition-colors ${isRTL ? 'text-right' : 'text-left'}`}\n                                />\n                                <button\n                                    type=\"submit\"\n                                    disabled={isLoading || !input.trim()}\n                                    className={`p-2 bg-blue-600 hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed rounded-xl text-white transition-colors ${isRTL ? 'rotate-180' : ''}`}\n                                >\n                                    <Send className=\"w-4 h-4\" />\n                                </button>\n                            </form>\n                            {/* Version Debug Indicator */}\n                            <div className=\"text-[10px] text-cyan-400 text-center mt-1 flex flex-col gap-0.5\" dir=\"ltr\">\n                                <span>System: v5.1 (Lucide Icons)</span>\n                            </div>\n                        </div>\n                    </motion.div>\n                )}\n            </AnimatePresence>\n\n            <button\n                onClick={() => setIsOpen(!isOpen)}\n                className=\"group flex items-center justify-center w-14 h-14 rounded-full text-white hover:scale-105 transition-all duration-300 backdrop-blur-md bg-white/10 border border-white/20 shadow-[0_0_15px_rgba(255,255,255,0.1)] hover:shadow-[0_0_25px_rgba(255,255,255,0.2)]\"\n            >\n                {isOpen ? (\n                    <X className=\"w-6 h-6\" />\n                ) : (\n                    <Bot className=\"w-7 h-7 group-hover:rotate-12 transition-transform\" />\n                )}\n            </button>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/InfoPanel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/Layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/MainMenu.tsx","messages":[{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\n/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/MainMenu.tsx:49:22\n  47 |             width: `${star.size}px`,\n  48 |             height: `${star.size}px`,\n> 49 |             opacity: Math.random() * 0.7 + 0.1,\n     |                      ^^^^^^^^^^^^^ Cannot call impure function\n  50 |             animationDuration: `${Math.random() * 3 + 2}s`\n  51 |         }));\n  52 |     }, [stars]);","line":49,"column":22,"nodeType":null,"endLine":49,"endColumn":35},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\n/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/MainMenu.tsx:50:35\n  48 |             height: `${star.size}px`,\n  49 |             opacity: Math.random() * 0.7 + 0.1,\n> 50 |             animationDuration: `${Math.random() * 3 + 2}s`\n     |                                   ^^^^^^^^^^^^^ Cannot call impure function\n  51 |         }));\n  52 |     }, [stars]);\n  53 |","line":50,"column":35,"nodeType":null,"endLine":50,"endColumn":48}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\nimport { useEffect, useRef, useState, useMemo } from 'react';\nimport { useProgress } from '@react-three/drei';\nimport { gsap } from 'gsap';\n\ninterface MainMenuProps {\n    onStart: () => void;\n}\n\nexport function MainMenu({ onStart }: MainMenuProps) {\n    const { progress } = useProgress();\n    const containerRef = useRef<HTMLDivElement>(null);\n    const [isLoaded, setIsLoaded] = useState(false);\n\n    // Dynamic Stars\n    const [stars, setStars] = useState<{ x: number; y: number; size: number; delay: number }[]>([]);\n\n    useEffect(() => {\n        // More stars, varying sizes\n        const newStars = Array.from({ length: 200 }).map(() => ({\n            x: Math.random() * 100,\n            y: Math.random() * 100,\n            size: Math.random() * 2 + 0.5,\n            delay: Math.random() * 5,\n        }));\n        setStars(newStars);\n\n        if (progress >= 100) {\n            setIsLoaded(true);\n        }\n    }, [progress]);\n\n    const handleStart = () => {\n        if (!isLoaded) return;\n        gsap.to(containerRef.current, {\n            opacity: 0,\n            duration: 2.0,\n            ease: \"power2.inOut\",\n            onComplete: () => onStart()\n        });\n    };\n\n    const starStyles = useMemo(() => {\n        return stars.map(star => ({\n            left: `${star.x}%`,\n            top: `${star.y}%`,\n            width: `${star.size}px`,\n            height: `${star.size}px`,\n            opacity: Math.random() * 0.7 + 0.1,\n            animationDuration: `${Math.random() * 3 + 2}s`\n        }));\n    }, [stars]);\n\n    return (\n        <div\n            ref={containerRef}\n            className=\"absolute inset-0 z-50 flex flex-col items-center justify-center bg-black text-white overflow-hidden font-sans\"\n            dir=\"rtl\"\n        >\n            {/* ğŸŒŒ DEEP SPACE BACKGROUND LAYERS */}\n            <div className=\"absolute inset-0 z-0 overflow-hidden\">\n                {/* 1. Deep Void Base */}\n                <div className=\"absolute inset-0 bg-[#020408]\" />\n\n                {/* 2. Volumetric Nebulas (CSS Blurs) - Deep Purple & Cosmic Blue */}\n                <div className=\"absolute top-[-20%] left-[-10%] w-[50%] h-[50%] bg-purple-900/20 blur-[120px] rounded-full animate-pulse-slow mix-blend-screen\" />\n                <div className=\"absolute bottom-[-20%] right-[-10%] w-[60%] h-[60%] bg-blue-900/20 blur-[130px] rounded-full animate-pulse-slow mix-blend-screen\" style={{ animationDelay: '2s' }} />\n                <div className=\"absolute top-[40%] right-[20%] w-[30%] h-[30%] bg-amber-900/10 blur-[100px] rounded-full animate-pulse-slow mix-blend-screen\" style={{ animationDelay: '4s' }} />\n\n                {/* 3. Orbital Rings (Celestial Mechanics) */}\n                <div className=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[120vh] h-[120vh] border border-white/5 rounded-full animate-[spin_120s_linear_infinite]\" />\n                <div className=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[160vh] h-[160vh] border border-white/5 rounded-full animate-[spin_180s_linear_infinite_reverse]\" />\n                <div className=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[90vh] h-[90vh] border border-white/5 rounded-full border-dashed animate-[spin_240s_linear_infinite]\" />\n\n                {/* 4. Starfield (Generated) */}\n                {stars.map((_star, i) => (\n                    <div\n                        key={i}\n                        className=\"absolute rounded-full bg-white animate-twinkle\"\n                        style={starStyles[i]}\n                    />\n                ))}\n\n                {/* 5. Constellation Lines (SVG Overlay) */}\n                <svg className=\"absolute inset-0 w-full h-full opacity-20 pointer-events-none stroke-white/20\">\n                    <line x1=\"10%\" y1=\"20%\" x2=\"15%\" y2=\"25%\" strokeWidth=\"0.5\" />\n                    <line x1=\"15%\" y1=\"25%\" x2=\"18%\" y2=\"15%\" strokeWidth=\"0.5\" />\n                    <line x1=\"80%\" y1=\"80%\" x2=\"85%\" y2=\"75%\" strokeWidth=\"0.5\" />\n                    <line x1=\"85%\" y1=\"75%\" x2=\"82%\" y2=\"65%\" strokeWidth=\"0.5\" />\n                    <line x1=\"82%\" y1=\"65%\" x2=\"75%\" y2=\"70%\" strokeWidth=\"0.5\" />\n                    {/* Random connection spiderweb effect */}\n                    <circle cx=\"15%\" cy=\"25%\" r=\"1\" fill=\"white\" />\n                    <circle cx=\"18%\" cy=\"15%\" r=\"1\" fill=\"white\" />\n                    <circle cx=\"85%\" cy=\"75%\" r=\"1\" fill=\"white\" />\n                </svg>\n\n                {/* 6. Shooting Stars */}\n                <div className=\"absolute top-[-10%] right-[-10%] w-[2px] h-[150px] bg-gradient-to-b from-transparent via-blue-100 to-transparent rotate-[45deg] animate-[shooting-star_7s_infinite]\" />\n                <div className=\"absolute top-[20%] right-[-10%] w-[1px] h-[100px] bg-gradient-to-b from-transparent via-white to-transparent rotate-[45deg] animate-[shooting-star_12s_infinite] delay-1000\" />\n\n                {/* 7. Vignette Texture */}\n                <div className=\"absolute inset-0 bg-radial-gradient-to-cc from-transparent via-transparent to-black/80\" />\n            </div>\n\n            {/* ğŸ•Œ CENTERPIECE: Islamic Geometry (Still present but subtle) */}\n            <div className=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] pointer-events-none opacity-10 z-0 mix-blend-overlay\">\n                <svg viewBox=\"0 0 100 100\" className=\"w-full h-full animate-[spin_200s_linear_infinite]\">\n                    <path d=\"M50 0 L61 35 L97 35 L68 57 L79 91 L50 70 L21 91 L32 57 L3 35 L39 35 Z\" fill=\"none\" stroke=\"#FFD700\" strokeWidth=\"0.2\" />\n                    <circle cx=\"50\" cy=\"50\" r=\"40\" fill=\"none\" stroke=\"#FFD700\" strokeWidth=\"0.05\" />\n                    <circle cx=\"50\" cy=\"50\" r=\"55\" fill=\"none\" stroke=\"#FFD700\" strokeWidth=\"0.05\" strokeDasharray=\"1 2\" />\n                </svg>\n            </div>\n\n            {/* UI CONTENT */}\n            <div className=\"relative z-10 text-center space-y-8 max-w-5xl px-6\">\n\n                {/* Branding with Deep Shadow */}\n                <div className=\"space-y-6 relative\">\n                    <div className=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[150%] h-[150%] bg-blue-500/5 blur-[80px] rounded-full pointer-events-none\" />\n\n                    <h1 className=\"relative text-7xl md:text-9xl font-bold font-serif tracking-tighter text-transparent bg-clip-text bg-gradient-to-b from-white via-amber-100 to-amber-600 drop-shadow-[0_0_50px_rgba(255,200,50,0.4)] animate-fade-in-up\">\n                        ÙÙ„Ùƒ ÙˆØ¢ÙŠØ©\n                    </h1>\n\n                    <div className=\"relative flex items-center justify-center gap-6 text-amber-100/60 animate-fade-in-up delay-200\">\n                        <span className=\"h-[0.5px] w-20 bg-gradient-to-r from-transparent to-amber-500/50\"></span>\n                        <p className=\"text-lg md:text-2xl font-light font-sans tracking-[0.2em] uppercase text-amber-50/90 drop-shadow-md\">\n                            Ø±Ø­Ù„Ø© ÙÙŠ Ø£Ø¹Ù…Ø§Ù‚ Ø§Ù„ÙƒÙˆÙ† ÙˆØªØ¯Ø¨Ø± Ø¢ÙŠØ§ØªÙ‡\n                        </p>\n                        <span className=\"h-[0.5px] w-20 bg-gradient-to-l from-transparent to-amber-500/50\"></span>\n                    </div>\n                </div>\n\n                {/* Start Interaction */}\n                <div className=\"min-h-[120px] flex flex-col items-center justify-center\">\n                    {!isLoaded ? (\n                        <div className=\"w-64 space-y-4 animate-pulse\">\n                            <div className=\"flex justify-between text-[9px] text-blue-200/40 font-mono tracking-[0.3em] uppercase\">\n                                <span>Orbit Synchronization</span>\n                                <span>{Math.round(progress)}%</span>\n                            </div>\n                            <div className=\"h-[1px] w-full bg-white/10 rounded-full overflow-hidden\">\n                                <div\n                                    className=\"h-full bg-gradient-to-r from-blue-400 via-white to-blue-400 blur-[1px] transition-all duration-300 ease-out\"\n                                    style={{ width: `${progress}%` }}\n                                />\n                            </div>\n                        </div>\n                    ) : (\n                        <div className=\"animate-fade-in-up delay-500\">\n                            <button\n                                onClick={handleStart}\n                                className=\"group relative px-14 py-5 bg-transparent overflow-hidden rounded-full transition-all duration-1000 hover:scale-105\"\n                            >\n                                {/* Thin Elegant Border */}\n                                <div className=\"absolute inset-0 border border-amber-200/20 rounded-full group-hover:border-amber-100/50 transition-colors duration-700\" />\n\n                                {/* Deep Space Glow on Hover */}\n                                <div className=\"absolute inset-0 bg-gradient-to-r from-blue-900/0 via-amber-500/5 to-blue-900/0 group-hover:via-amber-500/10 transition-all duration-700 blur-xl\" />\n\n                                <span className=\"relative z-10 text-xl font-light text-amber-50 tracking-[0.1em] group-hover:text-white transition-colors duration-500 flex items-center gap-4\">\n                                    <span>Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø±Ø­Ù„Ø©</span>\n                                </span>\n                            </button>\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* FOOTER CREDITS */}\n            <div className=\"absolute bottom-6 flex flex-col items-center space-y-3 opacity-50 hover:opacity-90 transition-opacity duration-700 group cursor-default\">\n                <div className=\"h-[1px] w-8 bg-amber-500/30 group-hover:w-24 transition-all duration-700\"></div>\n                <p className=\"text-amber-50/80 text-xs font-light tracking-widest font-serif\">\n                    Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø³Ù„ÙŠÙ…Ø§Ù† Ø§Ù„Ø·Ø®ÙŠÙ…\n                </p>\n                <p className=\"text-[8px] text-blue-200/30 uppercase tracking-[0.4em]\">\n                    Digital Architect\n                </p>\n            </div>\n        </div>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/Meteors.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/NavigationSidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/OrbitalTrails.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/PerformanceOptimizer.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":11,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":11,"endColumn":25},{"ruleId":"@typescript-eslint/no-unsafe-function-type","severity":2,"message":"The `Function` type accepts any function-like value.\nPrefer explicitly defining any function parameters and return type.","line":11,"column":32,"nodeType":"Identifier","messageId":"bannedFunctionType","endLine":11,"endColumn":40},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[415,418],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[415,418],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[447,450],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[447,450],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[461,464],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[461,464],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":21,"column":5,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":21,"endColumn":18,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[634,647],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":23,"column":9,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":23,"endColumn":22,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[677,690],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":42,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":42,"endColumn":19},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":51,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":51,"endColumn":31},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":54,"column":39,"nodeType":"BlockStatement","messageId":"unexpected","endLine":54,"endColumn":42,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[1706,1707],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":111,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":111,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3123,3126],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3123,3126],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":122,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":122,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3658,3661],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3658,3661],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":12,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect } from 'react';\n\n// Performance Optimization Code - Adapted for React/Three.js\n// Based on User Provided Implementation\n\n// 1. FPS Limiter/Monitor logic (Adapted for monitoring, since R3F manages the loop)\n// const targetFPS = 60;\n// const frameDelay = 1000 / targetFPS;\n\n// 3. Debounce Function for expensive operations\nexport function debounce(func: Function, delay = 100) {\n    let timeoutId: any;\n    return function (this: any, ...args: any[]) {\n        clearTimeout(timeoutId);\n        timeoutId = setTimeout(() => func.apply(this, args), delay);\n    };\n}\n\n// 4. Memory Cleanup\nfunction cleanupMemory() {\n    // @ts-ignore\n    if (window.gc) {\n        // @ts-ignore\n        window.gc();\n    }\n\n    // SAFEGUARDS: Only clear unused 2D canvases, NOT the WebGL 3D canvas\n    const canvases = document.querySelectorAll('canvas');\n    canvases.forEach(canvas => {\n        // Skip the main 3D canvas (managed by Three.js)\n        if (canvas.getAttribute('data-engine') === 'three.js') return;\n\n        // Only clear if it creates a 2D context (avoiding WebGL context loss errors)\n        try {\n            if (canvas.width > 0) {\n                // Check if it's a 2D canvas before getting context\n                const ctx = canvas.getContext('2d');\n                if (ctx) {\n                    ctx.clearRect(0, 0, canvas.width, canvas.height);\n                }\n            }\n        } catch (e) {\n            // Ignore errors for WebGL canvases\n        }\n    });\n\n\n}\n\n// 6. Reduce animation complexity based on device performance\nexport const detectPerformance = () => {\n    const startTime = performance.now();\n    // Simple performance test\n    for (let i = 0; i < 1000000; i++) { }\n    const duration = performance.now() - startTime;\n\n    let performanceMode = 'high';\n\n    if (duration > 50) {\n        performanceMode = 'low';\n    } else if (duration > 20) {\n        performanceMode = 'medium';\n    }\n\n\n    return performanceMode;\n};\n\n// 2. Image Loading Optimization\nfunction optimizeImages() {\n    const images = document.querySelectorAll('img');\n    images.forEach(img => {\n        if (!img.complete) {\n            img.loading = 'lazy';\n        }\n    });\n}\n\n// 7. Initialize optimizations\nfunction initPerformanceOptimizations() {\n    optimizeImages();\n    detectPerformance();\n\n    // Run cleanup every 30 seconds\n    setInterval(cleanupMemory, 30000);\n}\n\n// React Component Wrapper\n// Rewriting component to be scene-aware for cleanup\nimport * as THREE from 'three';\nimport { useThree } from '@react-three/fiber';\n\n// React Component Wrapper\n// Rewriting component to be scene-aware for cleanup\nexport function PerformanceOptimizer() {\n    const { scene, gl } = useThree();\n\n    useEffect(() => {\n        // Call on mount (simulating window.onload)\n        initPerformanceOptimizations();\n\n        const handleLoad = () => initPerformanceOptimizations();\n        window.addEventListener('load', handleLoad);\n\n        return () => {\n            window.removeEventListener('load', handleLoad);\n\n            // ğŸ§¹ MANUAL CLEANUP (User Requested)\n\n\n            const cleanMaterial = (material: any) => {\n                material.dispose();\n                if (material.map) material.map.dispose();\n                if (material.lightMap) material.lightMap.dispose();\n                if (material.bumpMap) material.bumpMap.dispose();\n                if (material.normalMap) material.normalMap.dispose();\n                if (material.specularMap) material.specularMap.dispose();\n                if (material.envMap) material.envMap.dispose();\n            };\n\n            scene.traverse((object) => {\n                if (!(object as any).isMesh) return;\n\n                const mesh = object as THREE.Mesh;\n                if (mesh.geometry) mesh.geometry.dispose();\n\n                if (mesh.material) {\n                    if (Array.isArray(mesh.material)) {\n                        mesh.material.forEach(m => cleanMaterial(m));\n                    } else {\n                        cleanMaterial(mesh.material);\n                    }\n                }\n            });\n\n            // Optional: Dispose renderer context if strictly needed, but typically R3F manages this.\n            // gl.dispose(); \n        };\n    }, [scene, gl]);\n\n    return null; // Invisible component\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/SimulationScene.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[752,755],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[752,755],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":52,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":52,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2023,2026],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2023,2026],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":94,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":94,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3708,3711],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3708,3711],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useRef, useEffect, Suspense } from 'react'\nimport * as THREE from 'three'\nimport { useFrame } from '@react-three/fiber'\nimport { useTexture } from '@react-three/drei'\nimport gsap from 'gsap'\nimport { Meteors } from './Meteors';\nimport { SpaceLightning } from './SpaceLightning';\n\nimport type { CelestialData } from '../types'\nimport { celestialObjects } from '../data/objects'\nimport { CelestialObject } from './CelestialObject'\n\n// ğŸ›¡ï¸ Component Boundary: Prevents one effect from crashing the whole scene\nclass ComponentBoundary extends React.Component<{ children: React.ReactNode }, { hasError: boolean }> {\n    state = { hasError: false }\n    static getDerivedStateFromError() { return { hasError: true } }\n    componentDidCatch(e: any) { console.warn(\"Visual Effect Failed:\", e); }\n    render() { return this.state.hasError ? null : this.props.children; }\n}\n\ninterface SimulationSceneProps {\n    onSelect: (data: CelestialData) => void;\n    isPaused: boolean;\n    onDateChange: (date: Date) => void;\n    isARMode?: boolean; // ğŸ¥ AR Prop\n    isMarathonMode?: boolean; // ğŸƒâ€â™‚ï¸ Marathon Mode Prop\n}\n\n// Base time scale: 1 = Real Time. 2 = Double Speed (Requested)\nconst BASE_TIME_SCALE = 2.0;\n\n// ğŸŒŒ 360 Space Background (High Res)\nfunction SpaceBackground() {\n    // FIX: Using reliable CDN URL to guarantee loading (bypassing local path issues)\n    const texture = useTexture(\"https://upload.wikimedia.org/wikipedia/commons/6/60/ESO_-_Milky_Way.jpg\")\n\n    return (\n        <mesh scale={[90000, 90000, 90000]}> {/* Increased scale to 90000 to cover far plane */}\n            <sphereGeometry args={[1, 64, 64]} />\n            <meshBasicMaterial\n                map={texture}\n                side={THREE.BackSide}\n                toneMapped={false} // Keep colors vivid\n            />\n        </mesh>\n    )\n}\n\n// ğŸª Planet Orbits (Visual Paths)\n// Renders static rings, optionally animated with dashed lines for \"High-Tech Radar\" look\n// Bypass TS conflict for <line> element\nconst ThreeLine = 'line' as any;\n\nfunction PlanetOrbits() {\n    const groupRef = useRef<THREE.Group>(null);\n    const orbitPlanets = ['mercury', 'venus', 'earth', 'mars', 'jupiter', 'saturn', 'uranus', 'neptune', 'pluto'];\n\n    // GSAP Fade-in Effect\n    useEffect(() => {\n        if (groupRef.current) {\n            // Animate opacity using GSAP\n            groupRef.current.children.forEach((child, index) => {\n                if (child instanceof THREE.Line) { // Changed to Line check\n                    const mat = child.material as THREE.LineDashedMaterial;\n                    const targetOpacity = 0.5; // Subtle opacity as requested\n                    mat.opacity = 0;\n                    gsap.to(mat, {\n                        opacity: targetOpacity,\n                        duration: 2.0, // Slower fade for elegance\n                        delay: index * 0.15,\n                        ease: \"power2.out\"\n                    });\n                }\n            });\n        }\n    }, []);\n\n    return (\n        <group ref={groupRef} rotation={[Math.PI / 2, 0, 0]}>\n            {celestialObjects.map((obj) => {\n                if (!orbitPlanets.includes(obj.id)) return null;\n\n                const r = obj.science.orbitRadius;\n\n                // Create Curve Geometry\n                const curve = new THREE.EllipseCurve(0, 0, r, r, 0, 2 * Math.PI, false, 0);\n                const points = curve.getPoints(128); // Smooth circle\n                const geometry = new THREE.BufferGeometry().setFromPoints(points);\n\n                return (\n                    <ThreeLine\n                        key={`orbit-${obj.id}`}\n                        geometry={geometry}\n                        onUpdate={(self: any) => {\n                            const line = self as THREE.Line;\n                            line.computeLineDistances();\n                        }}\n                    >\n                        <lineDashedMaterial\n                            color=\"#44aaff\"\n                            dashSize={3} // Requested: 3\n                            gapSize={1}  // Requested: 1\n                            scale={1}    // Adjust scale if dashes look too big/small relative to scene unit\n                            transparent={true}\n                            opacity={0} // Controlled by GSAP\n                            depthWrite={false}\n                            blending={THREE.AdditiveBlending}\n                        />\n                    </ThreeLine>\n                );\n            })}\n        </group>\n    );\n}\n\nexport default function SimulationScene({ onSelect, isPaused, onDateChange, isARMode = false, isMarathonMode = false }: SimulationSceneProps) {\n    const dateRef = useRef(new Date());\n    const lastUiUpdate = useRef(0);\n\n    // Use useFrame for loop but respect pause state\n    useFrame((state, delta) => {\n        if (isPaused) return;\n\n        const safeDelta = Math.min(delta, 0.1);\n        const effectiveTimeScale = BASE_TIME_SCALE;\n\n        dateRef.current = new Date(dateRef.current.getTime() + safeDelta * 1000 * effectiveTimeScale);\n\n        if (state.clock.elapsedTime - lastUiUpdate.current > 0.06) {\n            onDateChange(new Date(dateRef.current));\n            lastUiUpdate.current = state.clock.elapsedTime;\n        }\n    });\n\n    return (\n        <>\n            {/* ğŸŒŒ BACKGROUND SYSTEM */}\n            {/* If AR Mode: Show Webcam. Else: Show Space Background */}\n            <Suspense fallback={null}>\n                {isARMode ? (\n                    // Dynamic Import to avoid SSR/Initial load issues\n                    React.createElement(React.lazy(() => import('./WebcamLayer').then(module => ({ default: module.WebcamLayer }))))\n                ) : (\n                    <SpaceBackground />\n                )}\n            </Suspense>\n\n            {/* Reference Lighting Setup - Cinematic Deep Space Balance */}\n            <ambientLight intensity={0.42} color=\"#111122\" /> {/* Increased 20% (0.35 -> 0.42) */}\n\n            {/* Fill Light (Blueish) - Soft Rim Light */}\n            <pointLight\n                position={[50, 50, -100]}\n                intensity={0.6} // Increased 20% (0.5 -> 0.6)\n                color=\"#4466ff\"\n                distance={500}\n                decay={0.8}\n            />\n\n\n            {/* ğŸŒ  Shooting Stars (Every 15s) */}\n            <ComponentBoundary>\n                <Meteors />\n            </ComponentBoundary>\n\n            {/* âš¡ Space Lightning (Random Flashes) */}\n            <ComponentBoundary>\n                <Suspense fallback={null}>\n                    <SpaceLightning />\n                </Suspense>\n            </ComponentBoundary>\n\n            {/* ğŸª Orbit Rings (Visual Paths) */}\n            <PlanetOrbits />\n\n            {celestialObjects.map((obj) => (\n                <CelestialObject\n                    key={obj.id}\n                    data={obj}\n                    onSelect={onSelect}\n                    dateRef={dateRef}\n                    isMarathonMode={isARMode ? false : (isMarathonMode || false)} // Disable in AR, enable if prop is true\n                />\n            ))}\n        </>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/SmartRenderingManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/SpaceLightning.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":48,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2011,2014],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2011,2014],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":60,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":60,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":96,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":96,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":165,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":165,"endColumn":27}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useRef, useEffect, useState, memo, useMemo } from 'react';\nimport { useFrame } from '@react-three/fiber';\nimport { useTexture } from '@react-three/drei';\nimport * as THREE from 'three';\n\n// ğŸŒ©ï¸ AUDIO ASSETS ARRAY\n// A mix of local and reliable CDN assets for variety\nconst THUNDER_SOUNDS = [\n    `${import.meta.env.BASE_URL}sounds/thunder.ogg`,\n    'https://actions.google.com/sounds/v1/weather/thunder_heavy.ogg', // Heavy crack\n    'https://actions.google.com/sounds/v1/weather/thunder_rumble.ogg' // Deep rumble\n];\n\ninterface LightningBolt {\n    id: number;\n    position: THREE.Vector3;\n    rotation: THREE.Euler;\n    scale: THREE.Vector3;\n    life: number;\n    opacity: number;\n}\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// MAIN COMPONENT - WRAPPED WITH React.memo FOR ISOLATION\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nexport const SpaceLightning = memo(function SpaceLightning() {\n    // âš¡ REALISTIC TREE LIGHTNING TEXTURE\n    const texture = useTexture(`${import.meta.env.BASE_URL}textures/lightning_branch.png`);\n    const [bolts, setBolts] = useState<LightningBolt[]>([]);\n    const nextFlashTime = useRef(0);\n\n    // ğŸ”Š AUDIO ENGINE STATE (Web Audio API)\n    const [muted, setMuted] = useState(false);\n    const [hasInteracted, setHasInteracted] = useState(false);\n    const audioCtxRef = useRef<AudioContext | null>(null);\n    const buffersRef = useRef<AudioBuffer[]>([]);\n    const timeoutRefs = useRef<ReturnType<typeof setTimeout>[]>([]);\n\n    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n    // OPTIMIZATION 1: SINGLETON AUDIO SOURCE POOL\n    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n    const audioSourcePoolRef = useRef<AudioBufferSourceNode[]>([]);\n    const MAX_CONCURRENT_SOURCES = 3; // Limit concurrent audio instances\n\n    // 1. INITIALIZE AUDIO ENGINE & PRELOAD\n    useEffect(() => {\n        // Initialize Context\n        const AudioContext = window.AudioContext || (window as any).webkitAudioContext;\n        const ctx = new AudioContext() as AudioContext;\n        audioCtxRef.current = ctx;\n\n        // Preload All Sounds in Parallel (M4 Optimized)\n        const loadSound = async (url: string) => {\n            try {\n                const response = await fetch(url);\n                const arrayBuffer = await response.arrayBuffer();\n                // Decode asynchronously\n                const audioBuffer = await ctx.decodeAudioData(arrayBuffer);\n                buffersRef.current.push(audioBuffer);\n            } catch (e) {\n                console.warn(\"Audio Asset Failed:\", url);\n            }\n        };\n\n        // Fire all loads\n        THUNDER_SOUNDS.forEach(loadSound);\n\n        // Interaction Unlocker\n        const unlockAudio = () => {\n            // Resume context if suspended (Browser policy)\n            if (ctx.state === 'suspended') {\n                ctx.resume().then(() => setHasInteracted(true));\n            } else {\n                setHasInteracted(true);\n            }\n\n            // Cleanup listeners\n            window.removeEventListener('click', unlockAudio);\n            window.removeEventListener('touchstart', unlockAudio);\n            window.removeEventListener('keydown', unlockAudio);\n        };\n\n        window.addEventListener('click', unlockAudio);\n        window.addEventListener('touchstart', unlockAudio);\n        window.addEventListener('keydown', unlockAudio);\n\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n        // OPTIMIZATION 2: ENHANCED CLEANUP\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n        return () => {\n            // Stop all active audio sources\n            audioSourcePoolRef.current.forEach(source => {\n                try {\n                    source.stop();\n                    source.disconnect();\n                } catch (e) {\n                    // Source may already be stopped\n                }\n            });\n            audioSourcePoolRef.current = [];\n\n            // Close audio context\n            if (ctx) ctx.close();\n\n            // Remove event listeners\n            window.removeEventListener('click', unlockAudio);\n            window.removeEventListener('touchstart', unlockAudio);\n            window.removeEventListener('keydown', unlockAudio);\n\n            // Clear all pending timeouts\n            timeoutRefs.current.forEach(t => clearTimeout(t));\n            timeoutRefs.current = [];\n        };\n    }, []);\n\n    // âš¡ OPTIMIZED SPATIAL AUDIO TRIGGER WITH SOURCE REUSE\n    // ğŸ§ SYNC WITH EXTERNAL UI (AmbienceControl.tsx)\n    useEffect(() => {\n        const handleToggle = (e: CustomEvent) => {\n            const isMuted = e.detail.muted;\n            setMuted(isMuted);\n            setHasInteracted(true);\n\n            // Resume context if needed\n            if (!isMuted && audioCtxRef.current?.state === 'suspended') {\n                audioCtxRef.current.resume();\n            }\n        };\n\n        window.addEventListener('ambience-toggle', handleToggle as EventListener);\n        return () => window.removeEventListener('ambience-toggle', handleToggle as EventListener);\n    }, []);\n\n    // âš¡ OPTIMIZED SPATIAL AUDIO TRIGGER WITH SOURCE REUSE\n    const triggerThunder = (positionX: number) => {\n        if (muted || !hasInteracted || !audioCtxRef.current || buffersRef.current.length === 0) return;\n\n        const ctx = audioCtxRef.current;\n        const buffer = buffersRef.current[Math.floor(Math.random() * buffersRef.current.length)];\n\n        // Distance Delay logic REMOVED for \"Exact Moment\" Sync\n        // const delay = 200 + Math.random() * 800; \n\n        // Immediate Execution\n        // Guard: Context might be closed\n        if (ctx.state === 'closed') return;\n\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n        // OPTIMIZATION: LIMIT CONCURRENT AUDIO SOURCES\n        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n        // Clean up finished sources from pool\n        audioSourcePoolRef.current = audioSourcePoolRef.current.filter(source => {\n            // Remove sources that have already played\n            return source.context.state !== 'closed';\n        });\n\n        // Limit pool size to prevent memory overflow\n        if (audioSourcePoolRef.current.length >= MAX_CONCURRENT_SOURCES) {\n            // Stop and remove oldest source\n            const oldestSource = audioSourcePoolRef.current.shift();\n            if (oldestSource) {\n                try {\n                    oldestSource.stop();\n                    oldestSource.disconnect();\n                } catch (e) {\n                    // Already stopped\n                }\n            }\n        }\n\n        const source = ctx.createBufferSource();\n        source.buffer = buffer;\n\n        // 3D Spatial Audio (Pan based on X position)\n        // Simple Panner: -1 (Left) to 1 (Right)\n        // Map X range (-4000 to 4000) to (-1 to 1)\n        const panner = ctx.createStereoPanner();\n        const panValue = Math.max(-1, Math.min(1, positionX / 2000));\n        panner.pan.value = panValue;\n\n        // Volume Gain (Consistent \"Luxurious\" Level)\n        const gainNode = ctx.createGain();\n        gainNode.gain.value = 0.6; // Kept as requested\n\n        // Graph: Source -> Panner -> Gain -> Dest\n        source.connect(panner);\n        panner.connect(gainNode);\n        gainNode.connect(ctx.destination);\n\n        source.start(0);\n\n        // Track source\n        audioSourcePoolRef.current.push(source);\n    };\n\n    useFrame(({ clock }) => {\n        const time = clock.getElapsedTime();\n        // Storm active check handled by parent or logic? Assuming always active for demo or toggled.\n        // The variable 'isStormActive' was not defined in the scope of the snippet I saw, \n        // relying on previous code existence. Assuming 'true' or defined.\n        // Let's rely on the previous logic structure.\n\n        // Use a simpler check if variable isn't in scope of replacement:\n        const isStormActive = true;\n\n        // 1. SPAWN LOGIC - RARE & LUXURIOUS (Every 70 Seconds)\n        if (isStormActive && time > nextFlashTime.current) {\n            // Always trigger if time is up, no random skipping to ensure \"Rare but Reliable\"\n            if (bolts.length < 3) {\n                // Background Position (DEEP SPACE)\n                const radius = 4500;\n                const theta = Math.random() * Math.PI * 2;\n                const phi = Math.acos(2 * Math.random() - 1);\n\n                const x = radius * Math.sin(phi) * Math.cos(theta);\n                const y = radius * Math.sin(phi) * Math.sin(theta);\n                const z = radius * Math.cos(phi);\n\n                const position = new THREE.Vector3(x, y, z);\n                const size = 3000 + Math.random() * 3000;\n                const scale = new THREE.Vector3(size, size, 1);\n\n                const newBolt: LightningBolt = {\n                    id: Math.random(),\n                    position: position,\n                    rotation: new THREE.Euler(0, 0, Math.random() * Math.PI * 2),\n                    scale: scale,\n                    life: 1.0,\n                    opacity: 0,\n                };\n\n                setBolts(prev => [...prev, newBolt]);\n                triggerThunder(x);\n\n                // ğŸŒŸ EXACT 70 SECONDS INTERVAL ğŸŒŸ\n                nextFlashTime.current = time + 70.0;\n            }\n        }\n    });\n\n    const removeBolt = (id: number) => {\n        setBolts(prev => prev.filter(b => b.id !== id));\n    };\n\n    return (\n        <group>\n            {/* UI IS NOW HANDLED BY AmbienceControl.tsx in App.tsx */}\n            {\n                bolts.map(bolt => (\n                    <Bolt key={bolt.id} data={bolt} texture={texture} onComplete={() => removeBolt(bolt.id)} />\n                ))\n            }\n        </group >\n    );\n});\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// OPTIMIZATION 3: MEMOIZED BOLT COMPONENT WITH BufferGeometry\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nconst Bolt = memo(function Bolt({ data, texture, onComplete }: { data: LightningBolt, texture: THREE.Texture, onComplete: () => void }) {\n    const materialRef = useRef<THREE.MeshBasicMaterial>(null);\n    const lifeRef = useRef(1.0); // Start life\n\n    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n    // OPTIMIZATION 4: GPU-EFFICIENT BufferGeometry (Singleton)\n    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n    const geometry = useMemo(() => {\n        // Create optimized BufferGeometry once\n        const geo = new THREE.BufferGeometry();\n\n        // Define vertices for a plane (2 triangles)\n        const vertices = new Float32Array([\n            -0.5, -0.5, 0,  // Bottom-left\n            0.5, -0.5, 0,  // Bottom-right\n            0.5, 0.5, 0,  // Top-right\n            -0.5, 0.5, 0   // Top-left\n        ]);\n\n        // Define UVs for texture mapping\n        const uvs = new Float32Array([\n            0, 0,  // Bottom-left\n            1, 0,  // Bottom-right\n            1, 1,  // Top-right\n            0, 1   // Top-left\n        ]);\n\n        // Define indices (2 triangles)\n        const indices = new Uint16Array([\n            0, 1, 2,  // First triangle\n            0, 2, 3   // Second triangle\n        ]);\n\n        geo.setAttribute('position', new THREE.BufferAttribute(vertices, 3));\n        geo.setAttribute('uv', new THREE.BufferAttribute(uvs, 2));\n        geo.setIndex(new THREE.BufferAttribute(indices, 1));\n\n        return geo;\n    }, []);\n\n    useEffect(() => {\n        return () => {\n            geometry.dispose();\n        };\n    }, [geometry]);\n\n    useFrame((_, delta) => {\n        if (!materialRef.current) return;\n\n        // Decrement life directly on ref\n        lifeRef.current -= delta * 3.0;\n\n        if (lifeRef.current <= 0) {\n            onComplete();\n            return;\n        }\n\n        // Calculate opacity directly\n        let opacity = Math.sin(lifeRef.current * 20) * 0.5 + 0.5;\n        opacity *= lifeRef.current;\n\n        // Apply directly to material uniform WITHOUT triggering React render\n        materialRef.current.opacity = opacity;\n    });\n\n    return (\n        <mesh\n            position={data.position}\n            rotation={data.rotation}\n            scale={data.scale}\n            geometry={geometry || undefined}\n        >\n            {!geometry && <planeGeometry args={[1, 1]} />}\n            <meshBasicMaterial\n                ref={materialRef}\n                map={texture}\n                transparent={true}\n                opacity={0} // Controlled by ref\n                blending={THREE.AdditiveBlending}\n                side={THREE.DoubleSide}\n                depthWrite={false}\n                toneMapped={false}\n                color={new THREE.Color(\"#88ccff\").multiplyScalar(2)}\n            />\n        </mesh>\n    );\n}, (prevProps, nextProps) => {\n    // Custom comparison: only re-render if data.id changes\n    return prevProps.data.id === nextProps.data.id;\n});\n\n// Global Style for Animation\nconst style = document.createElement('style');\nstyle.innerHTML = `\n  @keyframes bounce {\n    0%, 100% { transform: translateY(0); }\n    50% { transform: translateY(-5px); }\n  }\n`;\ndocument.head.appendChild(style);\n","usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/SplashIntro.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/TimeControls.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/components/WebcamLayer.tsx","messages":[{"ruleId":"prefer-const","severity":2,"message":"'constraints' is never reassigned. Use 'const' instead.","line":20,"column":13,"nodeType":"Identifier","messageId":"useConst","endLine":20,"endColumn":48,"fix":{"range":[678,737],"text":"const constraints: MediaStreamConstraints = { audio: false };"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":69,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2625,2628],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2625,2628],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'videoRef.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'videoRef.current' to a variable inside the effect, and use that variable in the cleanup function.","line":102,"column":42,"nodeType":"Identifier","endLine":102,"endColumn":49},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'startWebcam'. Either include it or remove the dependency array.","line":106,"column":8,"nodeType":"ArrayExpression","endLine":106,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [startWebcam]","fix":{"range":[3962,3964],"text":"[startWebcam]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import { useEffect, useRef, useState } from 'react';\n\n// ğŸ¥ AR Webcam Overlay (HTML Video Background)\nexport function WebcamLayer() {\n    const videoRef = useRef<HTMLVideoElement>(null);\n    const [error, setError] = useState<string | null>(null);\n    const [logs, setLogs] = useState<string[]>([]);\n\n    const addLog = (msg: string) => {\n        console.log(`AR: ${msg}`);\n        setLogs(prev => [...prev.slice(-4), msg]); // Keep last 5 logs\n    };\n\n    const startWebcam = async (attemptLevel: 'hd-rear' | 'simple-rear' | 'any' = 'hd-rear') => {\n        const video = videoRef.current;\n        if (!video) return;\n\n        addLog(`Attempting: ${attemptLevel}...`);\n\n        let constraints: MediaStreamConstraints = { audio: false };\n\n        if (attemptLevel === 'hd-rear') {\n            constraints.video = { facingMode: 'environment', width: { ideal: 1920 }, height: { ideal: 1080 } };\n        } else if (attemptLevel === 'simple-rear') {\n            constraints.video = { facingMode: 'environment' };\n        } else {\n            constraints.video = true;\n        }\n\n        try {\n            addLog(\"Requesting stream...\");\n\n            // Watchdog: If stream takes > 5s, throw error\n            const streamPromise = navigator.mediaDevices.getUserMedia(constraints);\n            const timeoutPromise = new Promise((_, reject) =>\n                setTimeout(() => reject(new Error(\"Timeout: Stream took too long\")), 5000)\n            );\n\n            const stream = await Promise.race([streamPromise, timeoutPromise]) as MediaStream;\n\n            addLog(\"Stream acquired. Attaching...\");\n            video.srcObject = stream;\n\n            // ğŸ›¡ï¸ ANTI-FLICKER: Force Playback Logic\n            const forcePlay = () => {\n                if (video.paused) {\n                    video.play().catch(e => console.warn(\"Auto-resume failed\", e));\n                }\n            };\n\n            video.onloadedmetadata = () => {\n                addLog(\"Metadata loaded. Playing...\");\n                video.play()\n                    .then(() => {\n                        addLog(\"âœ… Video Playing!\");\n                        setLogs([]);\n                    })\n                    .catch(e => {\n                        addLog(`âŒ Play failed: ${e.message}`);\n                        console.error(e);\n                    });\n            };\n\n            // ğŸ›¡ï¸ ANTI-FLICKER: Event Listeners\n            video.onpause = () => { console.warn(\"AR: Paused! Resuming...\"); forcePlay(); };\n            video.onsuspend = () => { console.warn(\"AR: Suspended! Resuming...\"); forcePlay(); };\n\n            setError(null);\n        } catch (err: any) {\n            addLog(`âš ï¸ Attempt failed: ${err.message}`);\n\n            // Try next level\n            if (attemptLevel === 'hd-rear') {\n                startWebcam('simple-rear');\n            } else if (attemptLevel === 'simple-rear') {\n                startWebcam('any');\n            } else {\n                const errorMsg = err.name === 'NotAllowedError' || err.name === 'PermissionDeniedError'\n                    ? \"ØªÙ… Ø±ÙØ¶ Ø¥Ø°Ù† Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§. ÙŠØ±Ø¬Ù‰ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø°Ù† Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØµÙØ­.\"\n                    : `ÙØ´Ù„ ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§: ${err.name || 'Unknown'} - ${err.message}`;\n\n                setError(errorMsg);\n            }\n        }\n    };\n\n    useEffect(() => {\n        startWebcam('hd-rear');\n\n        // ğŸ›¡ï¸ ANTI-FLICKER: Persistent Watchdog\n        const interval = setInterval(() => {\n            const video = videoRef.current;\n            if (video && video.paused && video.srcObject) {\n                console.log(\"AR Watchdog: Forcing Playback\");\n                video.play().catch(() => { });\n            }\n        }, 1000);\n\n        return () => {\n            clearInterval(interval);\n            if (videoRef.current && videoRef.current.srcObject) {\n                const tracks = (videoRef.current.srcObject as MediaStream).getTracks();\n                tracks.forEach(track => track.stop());\n            }\n        };\n    }, []);\n\n    if (error) {\n        return (\n            <div className=\"fixed inset-0 z-[-10] bg-black flex flex-col items-center justify-center text-white text-center p-4\">\n                <div className=\"bg-red-900/50 p-6 rounded-xl border border-red-500/30 max-w-md\">\n                    <h3 className=\"text-xl font-bold mb-2\">âš ï¸ Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§</h3>\n                    <p className=\"mb-4 text-red-100\">{error}</p>\n                    <div className=\"text-left bg-black/50 p-2 rounded text-xs font-mono mb-4 text-gray-400\">\n                        {logs.map((l, i) => <div key={i}>{l}</div>)}\n                    </div>\n                    <button\n                        onClick={() => { setError(null); setLogs([]); startWebcam('hd-rear'); }}\n                        className=\"bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-full font-bold transition-colors\"\n                    >\n                        Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©\n                    </button>\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <>\n            {/* Debug Logs Overlay - Visible while loading */}\n            {logs.length > 0 && (\n                <div className=\"fixed top-20 left-4 z-50 pointer-events-none text-left\">\n                    {logs.map((log, i) => (\n                        <div key={i} className=\"text-green-400 text-xs font-mono bg-black/50 px-2 py-1 mb-1 rounded backdrop-blur-sm border border-green-500/20\">\n                            {log}\n                        </div>\n                    ))}\n                </div>\n            )}\n\n            <video\n                ref={videoRef}\n                autoPlay\n                playsInline\n                muted\n                className=\"fixed inset-0 w-full h-full object-cover z-[1] pointer-events-none\"\n                style={{\n                    position: 'fixed',\n                    top: 0,\n                    left: 0,\n                    width: '100%',\n                    height: '100%',\n                    objectFit: 'cover',\n                    zIndex: 1,\n                    pointerEvents: 'none',\n                    // ğŸ›¡ï¸ ANTI-FLICKER: Force GPU Layer\n                    willChange: 'transform',\n                    transform: 'translateZ(0)'\n                }}\n            />\n        </>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/data/objects.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/hooks/useAdaptiveQuality.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":34,"column":9,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":34,"endColumn":63,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[1154,1208],"text":"// @ts-expect-error - Safe default until manager initializes"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useRef } from 'react';\nimport {\n    AdaptivePerformanceManager,\n    getOptimalQualityLevel,\n    loadQualityPreference,\n    saveQualityPreference,\n    type PerformanceSettings,\n    type QualityLevel,\n} from '../utils/PerformanceManager';\n\nexport interface UseAdaptiveQualityReturn {\n    settings: PerformanceSettings;\n    quality: QualityLevel;\n    setQuality: (quality: QualityLevel) => void;\n    isAdaptive: boolean;\n    toggleAdaptive: () => void;\n}\n\n/**\n * React Hook for adaptive quality management\n * Automatically adjusts rendering quality based on performance\n */\nexport function useAdaptiveQuality(enableAdaptive: boolean = true): UseAdaptiveQualityReturn {\n    const managerRef = useRef<AdaptivePerformanceManager | null>(null);\n    const [isAdaptive, setIsAdaptive] = useState(enableAdaptive);\n\n    // Initialize with saved preference or optimal detection\n    const [quality, setQualityState] = useState<QualityLevel>(() => {\n        const saved = loadQualityPreference();\n        return saved || getOptimalQualityLevel();\n    });\n\n    const [settings, setSettings] = useState<PerformanceSettings>(() => {\n        // @ts-ignore - Safe default until manager initializes\n        return {\n            resolution: quality === 'high' ? 1 : quality === 'medium' ? 0.8 : 0.6,\n            pixelRatio: quality === 'high' ? 2 : 1,\n            antialiasing: quality !== 'low',\n            shadows: quality === 'high'\n        } as PerformanceSettings;\n    });\n\n    // Initialize manager\n    useEffect(() => {\n        if (!managerRef.current) {\n            managerRef.current = new AdaptivePerformanceManager(quality);\n            // Sync settings after init\n            setSettings(managerRef.current.getCurrentSettings());\n        }\n    }, [quality]);\n\n    // Update loop for adaptive quality\n    useEffect(() => {\n        if (!isAdaptive || !managerRef.current) return;\n\n        let animationFrameId: number;\n\n        const updateLoop = () => {\n            if (managerRef.current) {\n                const result = managerRef.current.update();\n\n                if (result.qualityChanged) {\n                    const newQuality = managerRef.current.getCurrentQuality();\n                    setQualityState(newQuality);\n                    setSettings(result.settings);\n                    saveQualityPreference(newQuality);\n                }\n            }\n\n            animationFrameId = requestAnimationFrame(updateLoop);\n        };\n\n        animationFrameId = requestAnimationFrame(updateLoop);\n\n        return () => {\n            cancelAnimationFrame(animationFrameId);\n        };\n    }, [isAdaptive]);\n\n    const setQuality = (newQuality: QualityLevel) => {\n        setQualityState(newQuality);\n        if (managerRef.current) {\n            managerRef.current.forceQuality(newQuality);\n            setSettings(managerRef.current.getCurrentSettings());\n        }\n        saveQualityPreference(newQuality);\n    };\n\n    const toggleAdaptive = () => {\n        setIsAdaptive(prev => !prev);\n    };\n\n    return {\n        settings,\n        quality,\n        setQuality,\n        isAdaptive,\n        toggleAdaptive,\n    };\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/i18n.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/utils/ContentValidator.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/utils/PerformanceManager.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/utils/astronomy.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/utils/performance-core.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Do not use \"@ts-nocheck\" because it alters compilation errors.","line":1,"column":1,"nodeType":"Line","messageId":"tsDirectiveComment","endLine":1,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":67,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2000,2003],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2000,2003],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":68,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2040,2043],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2040,2043],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":100,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":100,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3049,3052],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3049,3052],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":108,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":108,"endColumn":46},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":108,"column":48,"nodeType":"BlockStatement","messageId":"unexpected","endLine":108,"endColumn":51,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[3248,3249],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":148,"column":49,"nodeType":"Identifier","messageId":"unusedVar","endLine":148,"endColumn":50},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":148,"column":52,"nodeType":"BlockStatement","messageId":"unexpected","endLine":148,"endColumn":55,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[4546,4547],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":152,"column":20,"nodeType":"BlockStatement","messageId":"unexpected","endLine":154,"endColumn":14,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[4589,4603],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":197,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":197,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5714,5717],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5714,5717],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":198,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":198,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5755,5758],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5755,5758],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":202,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":202,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5876,5879],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5876,5879],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":218,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":218,"endColumn":23},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":218,"column":25,"nodeType":"BlockStatement","messageId":"unexpected","endLine":218,"endColumn":28,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[6393,6394],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":231,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":231,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6704,6707],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6704,6707],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":315,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":315,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9324,9327],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9324,9327],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":319,"column":53,"nodeType":"Identifier","messageId":"unusedVar","endLine":319,"endColumn":54},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":319,"column":56,"nodeType":"BlockStatement","messageId":"unexpected","endLine":319,"endColumn":59,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[9473,9474],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":537,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":537,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15669,15672],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15669,15672],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":542,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":542,"endColumn":46},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":542,"column":48,"nodeType":"BlockStatement","messageId":"unexpected","endLine":542,"endColumn":51,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[15818,15819],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":617,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":617,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17943,17946],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17943,17946],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":618,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":618,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18000,18003],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18000,18003],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":633,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":633,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18300,18303],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18300,18303],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":640,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":640,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18495,18498],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18495,18498],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":648,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":648,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18780,18783],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18780,18783],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":654,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":654,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18923,18926],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18923,18926],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":658,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":658,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19033,19036],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19033,19036],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"prefer-const","severity":2,"message":"'fpsHistory' is never reassigned. Use 'const' instead.","line":688,"column":9,"nodeType":"Identifier","messageId":"useConst","endLine":688,"endColumn":29,"fix":{"range":[19826,19856],"text":"const fpsHistory: number[] = [];"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":783,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":783,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22687,22690],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22687,22690],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":786,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":786,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":902,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":902,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26304,26307],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26304,26307],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":911,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":911,"endColumn":23},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":911,"column":25,"nodeType":"BlockStatement","messageId":"unexpected","endLine":911,"endColumn":28,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[26509,26510],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"@typescript-eslint/no-unused-expressions","severity":2,"message":"Expected an assignment or function call and instead saw an expression.","line":979,"column":1,"nodeType":"ExpressionStatement","messageId":"unusedExpression","endLine":1014,"endColumn":4},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":1069,"column":1,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":1069,"endColumn":92,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[31017,31108],"text":"// @ts-expect-error - Override signature is widely compatible but strict types sometimes complain"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1070,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1070,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[31184,31187],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[31184,31187],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1071,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1071,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[31234,31237],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[31234,31237],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":1272,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":1272,"endColumn":42},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":1272,"column":44,"nodeType":"BlockStatement","messageId":"unexpected","endLine":1272,"endColumn":47,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[37201,37202],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"prefer-const","severity":2,"message":"'lastScrollY' is never reassigned. Use 'const' instead.","line":1287,"column":5,"nodeType":"Identifier","messageId":"useConst","endLine":1287,"endColumn":16,"fix":{"range":[37507,37540],"text":"const lastScrollY = window.scrollY;"}},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'lastScrollY' is assigned a value but never used.","line":1287,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":1287,"endColumn":16},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1308,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1308,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[38058,38061],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[38058,38061],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":1346,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":1346,"endColumn":46},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":1346,"column":48,"nodeType":"BlockStatement","messageId":"unexpected","endLine":1346,"endColumn":51,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[39188,39189],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":1398,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":1398,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[40786,40789],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[40786,40789],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":46,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":2,"fixableWarningCount":0,"source":"// @ts-nocheck\n\n/**\n * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n * CRITICAL PERFORMANCE & STABILITY CODE\n * \n * âš ï¸  DO NOT REMOVE OR MODIFY THIS FILE\n * âš ï¸  REQUIRED FOR APP STABILITY\n * âš ï¸  REMOVING THIS WILL CAUSE SEVERE LAG AND CRASHES\n * \n * This file contains essential performance optimizations that:\n * - Prevent memory leaks\n * - Ensure smooth 60 FPS\n * - Prevent crashes\n * - Optimize rendering\n * - Handle errors gracefully\n * \n * Last Updated: 2026-01-26\n * Status: PRODUCTION CRITICAL\n * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n */\n\n/**\n * ğŸš€ Performance Engine\n * v2.0 - PERMANENT (Do not remove)\n * A comprehensive suite of optimization layers to prevent memory leaks and improve runtime performance.\n * \n * Includes:\n * 1. Memory Leak Prevention\n * 2. Element Recycling\n * 3. Intelligent Throttling\n * 4. RAF Pooling\n * 5. Passive Event Listeners\n * 6. Intelligent Garbage Collection\n * 7. CSS Containment (Applied via injected styles or class names)\n * 8. Deferred Initialization\n * \n * ADDITIONAL STABILITY LAYERS:\n * 1. Critical Error Boundary\n * 2. Render Throttling\n * 3. Canvas Optimization\n * 4. Image Loading Optimization\n * 5. Touch/Gesture Optimization\n * 6. Resource Hints\n * 7. Network Error Recovery\n * 8. Focus Management\n * 9. Scroll Performance\n * 10. Orientation Change Handler\n * 11. Memory Pressure Detection\n * 12. Safe Animation Cleanup\n */\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// EMERGENCY MEMORY PROTECTION - ERROR CODE 5 FIX\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\ndeclare global {\n    interface Window {\n        gc?: () => void;\n        createStarField?: () => void;\n        createStars?: () => void;\n        createRealisticStars?: () => void;\n        createParticles?: () => void;\n        createPlasmaParticles?: () => void;\n        createCosmicParticles?: () => void;\n        createShootingStars?: () => void;\n        getPooledElement?: (type?: string, className?: string) => any;\n        recycleElement?: (element: any) => void;\n        addAnimationCallback?: (callback: (timestamp: number) => void) => void;\n        removeAnimationCallback?: (callback: (timestamp: number) => void) => void;\n        errorLog?: Array<{\n            message: string;\n            source: string;\n            line: number;\n            time: string;\n        }>;\n        batchRead?: (fn: () => void) => void;\n        batchWrite?: (fn: () => void) => void;\n        loadImageOptimized?: (src: string) => Promise<HTMLImageElement>;\n    }\n    interface Performance {\n        memory?: {\n            usedJSHeapSize: number;\n            jsHeapSizeLimit: number;\n        };\n    }\n}\n\n(function emergencyMemoryProtection() {\n    'use strict';\n\n\n\n    // CRITICAL: Stop ALL element creation after threshold\n    let totalElementsCreated = 0;\n    const MAX_ELEMENTS = 5000; // Increased from 500 to 5000 for React stability\n\n    // Override createElement\n    const originalCreateElement = document.createElement;\n    document.createElement = function (tagName: any) {\n        totalElementsCreated++;\n\n        if (totalElementsCreated > MAX_ELEMENTS) {\n\n\n            // Force cleanup\n            if (window.gc) {\n                try { window.gc(); } catch (e) { }\n            }\n\n            // Remove old elements\n            const removable = document.querySelectorAll('.star, .particle, [class*=\"temp-\"]');\n            removable.forEach((el, i) => {\n                if (i < removable.length - 50) { // Keep last 50\n                    el.remove();\n                }\n            });\n\n            totalElementsCreated = 0; // Reset counter\n        }\n\n        return originalCreateElement.call(this, tagName);\n    };\n\n    // Smart cleanup - only when needed (every 30 seconds)\n    setInterval(() => {\n\n\n        // Only cleanup if needed\n        if (performance.memory) {\n            const usedMB = performance.memory.usedJSHeapSize / 1048576;\n\n            // Only cleanup if memory > 80MB\n            if (usedMB > 80) {\n                // Remove excess stars (keep 50)\n                const stars = document.querySelectorAll('.star, [class*=\"star\"]');\n                stars.forEach((el, i) => {\n                    if (i > 50) el.remove();\n                });\n\n                // Remove all particles\n                document.querySelectorAll('.particle, [class*=\"particle\"]').forEach(el => {\n                    el.remove();\n                });\n\n                // Force GC\n                if (window.gc) {\n                    try { window.gc(); } catch (e) { }\n                }\n\n\n            } else {\n\n            }\n\n            // If memory too high, perform silent recovery\n            if (usedMB > 150) {\n\n\n                // Silent aggressive cleanup instead of reload\n                performSilentCleanup();\n\n                // Reset memory counter\n                totalElementsCreated = 0;\n            }\n        }\n\n    }, 30000); // Every 30 seconds (less aggressive)\n\n    // Silent cleanup function\n    function performSilentCleanup() {\n\n\n        // 1. Remove ALL non-essential elements\n        const removable = document.querySelectorAll(`\n            .star,\n            [class*=\"star\"],\n            .particle,\n            [class*=\"particle\"],\n            .shooting-star,\n            [class*=\"shooting\"],\n            .cosmic-dust,\n            [class*=\"cosmic\"],\n            [class*=\"nebula-dust\"],\n            [class*=\"glow-particle\"]\n        `);\n\n        removable.forEach(el => {\n            el.remove();\n        });\n\n\n\n        // 2. Stop all animations temporarily\n        const animated = document.querySelectorAll('[style*=\"animation\"]');\n        animated.forEach(el => {\n            const oldAnimation = (el as any).style.animation;\n            (el as any).style.animation = 'none';\n\n            // Restart after 100ms\n            setTimeout(() => {\n                (el as any).style.animation = oldAnimation;\n            }, 100);\n        });\n\n        // 3. Clear all intervals except essential ones\n        const highestId = window.setInterval(() => { }, 0);\n        for (let i = 100; i < highestId; i++) { // Keep first 100 (essential)\n            window.clearInterval(i);\n        }\n\n        // 4. Force multiple GC cycles\n        if (window.gc) {\n            try {\n                for (let i = 0; i < 3; i++) {\n                    window.gc();\n                }\n            } catch (e) { }\n        }\n\n        // 5. Reduce quality mode\n        document.body.dataset.perfMode = 'low';\n\n\n\n        // Show subtle notification (no alert!)\n        showSubtleNotification('ØªÙ… ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø¨Ù†Ø¬Ø§Ø­');\n    }\n\n    // Subtle notification system (no blocking alert!)\n    function showSubtleNotification(message: any) {\n        const notification = document.createElement('div');\n        notification.style.cssText = `\n            position: fixed;\n            bottom: 20px;\n            right: 20px;\n            background: rgba(0, 0, 0, 0.8);\n            color: white;\n            padding: 15px 20px;\n            border-radius: 8px;\n            font-family: 'Cairo', sans-serif;\n            font-size: 14px;\n            z-index: 10000;\n            animation: slideIn 0.3s ease;\n            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n        `;\n        notification.textContent = message;\n\n        // Add animation\n        const style = document.createElement('style');\n        style.textContent = `\n            @keyframes slideIn {\n                from {\n                    transform: translateX(400px);\n                    opacity: 0;\n                }\n                to {\n                    transform: translateX(0);\n                    opacity: 1;\n                }\n            }\n            @keyframes slideOut {\n                from {\n                    transform: translateX(0);\n                    opacity: 1;\n                }\n                to {\n                    transform: translateX(400px);\n                    opacity: 0;\n                }\n            }\n        `;\n        document.head.appendChild(style);\n\n        document.body.appendChild(notification);\n\n        // Auto remove after 3 seconds\n        setTimeout(() => {\n            notification.style.animation = 'slideOut 0.3s ease';\n            setTimeout(() => notification.remove(), 300);\n        }, 3000);\n    }\n\n    // CRITICAL: Stop ALL intervals after 5 minutes\n    setTimeout(() => {\n\n\n        const highestId = window.setInterval(() => { }, 0);\n        for (let i = 0; i < highestId; i++) {\n            window.clearInterval(i);\n        }\n\n\n    }, 300000); // After 5 minutes\n\n    // CRITICAL: Monitor memory continuously\n    let lastMemoryCheck = 0;\n    function monitorMemory() {\n        const now = performance.now();\n\n        if (now - lastMemoryCheck > 5000) { // Every 5 seconds\n            if (performance.memory) {\n                const memoryUsage = performance.memory.usedJSHeapSize / performance.memory.jsHeapSizeLimit;\n\n                if (memoryUsage > 0.85) { // 85% full\n\n\n                    // Emergency actions\n                    document.querySelectorAll('.star, .particle, [class*=\"nebula\"], [class*=\"glow\"]').forEach(el => {\n                        el.remove();\n                    });\n\n                    // Stop all animations\n                    document.querySelectorAll('*').forEach(el => {\n                        (el as any).style.animation = 'none';\n                    });\n\n                    if (window.gc) {\n                        try { window.gc(); } catch (e) { }\n                    }\n                }\n            }\n\n            lastMemoryCheck = now;\n        }\n\n        requestAnimationFrame(monitorMemory);\n    }\n    monitorMemory();\n\n\n})();\n\n// DISABLE heavy element creation\n(function disableHeavyFeatures() {\n    'use strict';\n\n    // Stop star creation functions\n    window.createStarField = function () {\n\n    };\n    window.createStars = function () {\n\n    };\n    window.createRealisticStars = function () {\n\n    };\n\n    // Stop particle creation\n    window.createParticles = function () {\n\n    };\n    window.createPlasmaParticles = function () {\n\n    };\n    window.createCosmicParticles = function () {\n\n    };\n\n    // Stop shooting stars\n    window.createShootingStars = function () {\n\n    };\n\n\n})();\n\n// Optional refresh suggestion (not forced)\n(function gentleRefreshSuggestion() {\n    'use strict';\n\n    // After 30 minutes, suggest refresh (not force)\n    setTimeout(() => {\n        if (performance.memory) {\n            const usedMB = performance.memory.usedJSHeapSize / 1048576;\n\n            // Only suggest if memory is actually high\n            if (usedMB > 100) {\n                // Add refresh button to notification\n                const notification = document.createElement('div');\n                notification.style.cssText = `\n                    position: fixed;\n                    bottom: 20px;\n                    left: 50%;\n                    transform: translateX(-50%);\n                    background: rgba(0, 0, 0, 0.9);\n                    color: white;\n                    padding: 20px 30px;\n                    border-radius: 12px;\n                    font-family: 'Cairo', sans-serif;\n                    z-index: 10000;\n                    display: flex;\n                    gap: 15px;\n                    align-items: center;\n                    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);\n                `;\n\n                notification.innerHTML = `\n                    <span>Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙØ¶Ù„ Ø£Ø¯Ø§Ø¡ØŒ ÙŠÙÙ†ØµØ­ Ø¨ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©</span>\n                    <button onclick=\"window.location.reload()\" style=\"\n                        background: #4CAF50;\n                        color: white;\n                        border: none;\n                        padding: 8px 20px;\n                        border-radius: 6px;\n                        cursor: pointer;\n                        font-family: 'Cairo', sans-serif;\n                        font-size: 14px;\n                    \">ØªØ­Ø¯ÙŠØ«</button>\n                    <button onclick=\"this.parentElement.remove()\" style=\"\n                        background: transparent;\n                        color: white;\n                        border: 1px solid white;\n                        padding: 8px 20px;\n                        border-radius: 6px;\n                        cursor: pointer;\n                        font-family: 'Cairo', sans-serif;\n                        font-size: 14px;\n                    \">Ù„Ø§Ø­Ù‚Ø§Ù‹</button>\n                `;\n\n                document.body.appendChild(notification);\n            }\n        }\n    }, 1800000); // After 30 minutes\n\n\n})();\n\n// Memory status indicator\n(function memoryIndicator() {\n    'use strict';\n\n    const indicator = document.createElement('div');\n    indicator.style.cssText = `\n        position: fixed;\n        bottom: 10px;\n        left: 10px;\n        background: rgba(0, 0, 0, 0.7);\n        color: white;\n        padding: 5px 10px;\n        border-radius: 5px;\n        font-family: monospace;\n        font-size: 11px;\n        z-index: 9999;\n        display: none; /* Hidden by default */\n    `;\n    document.body.appendChild(indicator);\n\n    // Update every 5 seconds\n    setInterval(() => {\n        if (performance.memory) {\n            const usedMB = (performance.memory.usedJSHeapSize / 1048576).toFixed(0);\n            const limitMB = (performance.memory.jsHeapSizeLimit / 1048576).toFixed(0);\n            const percent = ((performance.memory.usedJSHeapSize / performance.memory.jsHeapSizeLimit) * 100).toFixed(0);\n\n            indicator.textContent = `ğŸ’¾ ${usedMB}/${limitMB} MB (${percent}%)`;\n\n            // Color based on usage\n            if (Number(percent) > 80) {\n                indicator.style.background = 'rgba(255, 0, 0, 0.8)';\n                indicator.style.display = 'block'; // Show when high\n            } else if (Number(percent) > 60) {\n                indicator.style.background = 'rgba(255, 165, 0, 0.8)';\n                indicator.style.display = 'block';\n            } else {\n                indicator.style.display = 'none'; // Hide when OK\n            }\n        }\n    }, 5000);\n\n\n})();\n\n// Simplify all animations\n(function simplifyAnimations() {\n    'use strict';\n\n    // Reduce to essential animations only\n    const style = document.createElement('style');\n    style.textContent = `\n        /* Disable expensive animations */\n        .star,\n        .particle,\n        [class*=\"shooting\"],\n        [class*=\"cosmic\"],\n        .nebula-dust,\n        [class*=\"glow-\"] {\n            display: none !important;\n        }\n        \n        /* Simplify planet animations */\n        .planet,\n        [class*=\"planet\"] {\n            animation-duration: 10s !important;\n            animation-timing-function: linear !important;\n        }\n        \n        /* Remove shadows */\n        * {\n            box-shadow: none !important;\n            text-shadow: 0 0 5px currentColor !important;\n        }\n        \n        /* Disable filters */\n        * {\n            filter: none !important;\n            backdrop-filter: none !important;\n        }\n    `;\n    document.head.appendChild(style);\n\n\n})();\n\n// Error recovery for Error 5\n(function errorRecovery() {\n    'use strict';\n\n    window.addEventListener('error', (event) => {\n\n\n        // If memory error, try to recover\n        if (event.message.includes('memory') ||\n            event.message.includes('heap') ||\n            event.message.includes('out of memory')) {\n\n\n\n            // Emergency cleanup\n            document.querySelectorAll('.star, .particle, [class*=\"temp\"]').forEach(el => {\n                el.remove();\n            });\n\n            // Stop all animations\n            document.querySelectorAll('*').forEach(el => {\n                (el as any).style.animation = 'none';\n            });\n\n            // Force GC\n            if (window.gc) {\n                try { window.gc(); } catch (e) { }\n            }\n\n            // Show message\n            alert('ØªÙ… Ø§ÙƒØªØ´Ø§Ù Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø©. Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...');\n\n            // Reload after cleanup\n            setTimeout(() => {\n                window.location.reload();\n            }, 3000);\n\n            event.preventDefault();\n            return true;\n        }\n    });\n\n    // Also catch unhandled promise rejections\n    window.addEventListener('unhandledrejection', (event) => {\n\n        event.preventDefault();\n    });\n\n\n})();\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// OPTIMIZATION 1: MEMORY LEAK PREVENTION\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n(function preventMemoryLeaks() {\n    'use strict';\n\n\n\n    // Track all intervals and timeouts\n    const intervals = new Set();\n    const timeouts = new Set();\n\n    // Wrap setInterval to track them\n    const originalSetInterval = window.setInterval;\n    window.setInterval = function (callback, delay, ...args) {\n        const id = originalSetInterval(callback, delay, ...args);\n        intervals.add(id);\n        return id;\n    };\n\n    // Wrap clearInterval to untrack\n    const originalClearInterval = window.clearInterval;\n    window.clearInterval = function (id) {\n        intervals.delete(id);\n        return originalClearInterval(id);\n    };\n\n    // Wrap setTimeout to track them\n    const originalSetTimeout = window.setTimeout;\n    window.setTimeout = function (callback, delay, ...args) {\n        const id = originalSetTimeout(callback, delay, ...args);\n        timeouts.add(id);\n        return id;\n    };\n\n    // Wrap clearTimeout to untrack\n    const originalClearTimeout = window.clearTimeout;\n    window.clearTimeout = function (id) {\n        timeouts.delete(id);\n        return originalClearTimeout(id);\n    };\n\n    // Auto cleanup old completed timeouts\n    setInterval(() => {\n        // Timeouts cleanup happens automatically\n        // console.log(`ğŸ“Š Active Intervals: ${intervals.size}, Timeouts: ${timeouts.size}`);\n    }, 30000);\n\n    // Cleanup on page unload\n    window.addEventListener('beforeunload', () => {\n        intervals.forEach(id => clearInterval(id as any));\n        timeouts.forEach(id => clearTimeout(id as any));\n    });\n\n\n})();\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// OPTIMIZATION 2: DOM ELEMENT RECYCLING\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n(function elementRecycling() {\n    'use strict';\n\n\n\n    // Pools for different element types\n    const pools: Record<string, any[]> = {\n        stars: [],\n        particles: [],\n        generic: []\n    };\n\n    // Get element from pool or create new\n    window.getPooledElement = function (type = 'div', className = ''): any {\n        const poolKey = className.includes('star') ? 'stars' :\n            className.includes('particle') ? 'particles' : 'generic';\n\n        let element = pools[poolKey].pop();\n\n        if (!element) {\n            element = document.createElement(type);\n            (element as any).dataset.pooled = 'true';\n        }\n\n        element.className = className;\n        element.style.display = '';\n\n        return element as any;\n    };\n\n    // Return element to pool instead of removing\n    window.recycleElement = function (element: any) {\n        if (!element || !element.dataset.pooled) return;\n\n        element.style.display = 'none';\n        element.style.animation = 'none';\n\n        if (element.parentNode) {\n            element.parentNode.removeChild(element);\n        }\n\n        const poolKey = element.className.includes('star') ? 'stars' :\n            element.className.includes('particle') ? 'particles' : 'generic';\n\n        if (pools[poolKey].length < 100) { // Max 100 per pool\n            pools[poolKey].push(element);\n        }\n    };\n\n\n})();\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// OPTIMIZATION 3: INTELLIGENT THROTTLING\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n(function adaptivePerformance() {\n    'use strict';\n\n\n\n    let performanceMode = 'high'; // high, medium, low\n    let fpsHistory: number[] = [];\n    let lastFPSCheck = 0;\n\n    // Measure FPS continuously\n    let frameCount = 0;\n    let lastFrameTime = performance.now();\n\n    function measureFPS() {\n        frameCount++;\n        const currentTime = performance.now();\n\n        if (currentTime >= lastFrameTime + 1000) {\n            const fps = Math.round(frameCount * 1000 / (currentTime - lastFrameTime));\n            fpsHistory.push(fps);\n\n            if (fpsHistory.length > 10) {\n                fpsHistory.shift();\n            }\n\n            frameCount = 0;\n            lastFrameTime = currentTime;\n\n            // Check every 5 seconds\n            if (currentTime - lastFPSCheck > 5000) {\n                adjustPerformanceMode();\n                lastFPSCheck = currentTime;\n            }\n        }\n\n        requestAnimationFrame(measureFPS);\n    }\n\n    function adjustPerformanceMode() {\n        if (fpsHistory.length < 5) return;\n\n        const avgFPS = fpsHistory.reduce((a, b) => a + b, 0) / fpsHistory.length;\n        const newMode = avgFPS < 25 ? 'low' : avgFPS < 45 ? 'medium' : 'high';\n\n        if (newMode !== performanceMode) {\n            performanceMode = newMode;\n            performanceMode = newMode;\n            applyPerformanceMode();\n        }\n    }\n\n    function applyPerformanceMode() {\n        const root = document.documentElement;\n\n        switch (performanceMode) {\n            case 'low':\n                // Reduce animation complexity\n                root.style.setProperty('--animation-duration', '3s');\n                root.style.setProperty('--particle-count', '10');\n                // Reduce updates frequency\n                document.body.dataset.perfMode = 'low';\n                break;\n\n            case 'medium':\n                root.style.setProperty('--animation-duration', '2s');\n                root.style.setProperty('--particle-count', '30');\n                document.body.dataset.perfMode = 'medium';\n                break;\n\n            case 'high':\n                root.style.setProperty('--animation-duration', '1s');\n                root.style.setProperty('--particle-count', '50');\n                document.body.dataset.perfMode = 'high';\n                break;\n        }\n\n        // Dispatch event for other systems to react\n        window.dispatchEvent(new CustomEvent('performanceModeChange', {\n            detail: { mode: performanceMode }\n        }));\n    }\n\n    // Start monitoring\n    requestAnimationFrame(measureFPS);\n\n\n})();\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// OPTIMIZATION 4: REQUEST ANIMATION FRAME POOLING\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n(function rafPooling() {\n    'use strict';\n\n\n\n    const callbacks = new Set();\n    let rafId: number | null = null;\n    let isRunning = false;\n\n    function masterLoop(timestamp: number) {\n        callbacks.forEach((callback: any) => {\n            try {\n                callback(timestamp);\n            } catch (e) {\n                // Silenced error\n            }\n        });\n\n        if (callbacks.size > 0) {\n            rafId = requestAnimationFrame(masterLoop);\n        } else {\n            isRunning = false;\n            rafId = null;\n        }\n    }\n\n    // Public API\n    window.addAnimationCallback = function (callback) {\n        callbacks.add(callback);\n\n        if (!isRunning) {\n            isRunning = true;\n            rafId = requestAnimationFrame(masterLoop);\n        }\n\n        return callback; // Return for removal\n    };\n\n    window.removeAnimationCallback = function (callback) {\n        callbacks.delete(callback);\n    };\n\n    // Pause when tab is hidden\n    document.addEventListener('visibilitychange', () => {\n        if (document.hidden && rafId) {\n            cancelAnimationFrame(rafId);\n            rafId = null;\n            isRunning = false;\n        } else if (!document.hidden && callbacks.size > 0 && !isRunning) {\n            isRunning = true;\n            rafId = requestAnimationFrame(masterLoop);\n        }\n    });\n\n    console.log('âœ… RAF Pooling: Active');\n})();\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// OPTIMIZATION 5: PASSIVE EVENT LISTENERS\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n(function passiveListeners() {\n    'use strict';\n\n    console.log('ğŸ‘† Passive Listeners: Starting...');\n\n    // Override addEventListener for passive events\n    const originalAddEventListener = EventTarget.prototype.addEventListener;\n\n    EventTarget.prototype.addEventListener = function (type, listener, options) {\n        const passiveEvents = ['scroll', 'wheel', 'touchstart', 'touchmove', 'touchend'];\n\n        if (passiveEvents.includes(type)) {\n            if (typeof options === 'boolean') {\n                options = { capture: options, passive: true };\n            } else if (typeof options === 'object') {\n                options.passive = true;\n            } else {\n                options = { passive: true };\n            }\n        }\n\n        return originalAddEventListener.call(this, type, listener, options);\n    };\n\n    console.log('âœ… Passive Listeners: Active');\n})();\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// OPTIMIZATION 6: INTELLIGENT GARBAGE COLLECTION\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n(function intelligentGC() {\n    'use strict';\n\n    console.log('ğŸ—‘ï¸ Intelligent GC: Starting...');\n\n    let lastCleanup = performance.now();\n    const CLEANUP_INTERVAL = 30000; // 30 seconds\n\n    function shouldCleanup() {\n        // Check if enough time passed\n        if (performance.now() - lastCleanup < CLEANUP_INTERVAL) {\n            return false;\n        }\n\n        // Check if memory usage is high\n        if (performance.memory) {\n            const usedMB = performance.memory.usedJSHeapSize / 1048576;\n            return usedMB > 50; // More than 50MB\n        }\n\n        return true;\n    }\n\n    function performCleanup() {\n        if (!shouldCleanup()) return;\n\n        // console.log('ğŸ—‘ï¸ Performing cleanup...');\n\n        // Clear detached elements\n        const allElements = document.querySelectorAll('*');\n        allElements.forEach(el => {\n            if (!el.isConnected && el.parentNode === null) {\n                // Element is detached, help GC by clearing references\n                el.textContent = '';\n                el.innerHTML = '';\n\n                // Clear event listeners by cloning\n                const clone = el.cloneNode(false);\n                if (el.parentNode) {\n                    (el.parentNode as any).replaceChild(clone, el);\n                }\n            }\n        });\n\n        // Force GC if available\n        if (window.gc) {\n            try {\n                window.gc();\n            } catch (e) { }\n        }\n\n        lastCleanup = performance.now();\n\n        if (performance.memory) {\n            // const usedMB = (performance.memory.usedJSHeapSize / 1048576).toFixed(1);\n            // console.log(`âœ… Cleanup done. Memory: ${usedMB} MB`);\n        }\n    }\n\n    // Schedule regular cleanup\n    setInterval(performCleanup, CLEANUP_INTERVAL);\n\n    // Cleanup when tab becomes visible\n    document.addEventListener('visibilitychange', () => {\n        if (!document.hidden) {\n            performCleanup();\n        }\n    });\n\n    console.log('âœ… Intelligent GC: Active');\n})();\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// OPTIMIZATION 7: CSS CONTAINMENT (Handled via CSS file, checking logging here)\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\nconsole.log('ğŸ¨ CSS Containment: Rules applied via index.css');\n\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// OPTIMIZATION 8: DEFERRED INITIALIZATION\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n(function deferredInit() {\n    'use strict';\n\n    console.log('â³ Deferred Initialization: Starting...');\n\n    // Wait for initial render\n    if (document.readyState === 'loading') {\n        document.addEventListener('DOMContentLoaded', scheduleHeavyTasks);\n    } else {\n        scheduleHeavyTasks();\n    }\n\n    function scheduleHeavyTasks() {\n        // Use requestIdleCallback if available\n        const schedule = window.requestIdleCallback || window.setTimeout;\n\n        // Schedule heavy initializations\n        schedule(() => {\n            console.log('â³ Initializing non-critical features...');\n\n            // Initialize features that aren't immediately visible\n            // Your initialization code here\n\n            console.log('âœ… Non-critical features initialized');\n        }, { timeout: 2000 });\n    }\n\n    console.log('âœ… Deferred Initialization: Scheduled');\n})();\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// ADDITIONAL STABILITY LAYER - 100% SAFE\n// Add to performance-core.js after existing code\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n(function additionalStability() {\n    'use strict';\n\n    console.log('ğŸ›¡ï¸ Additional Stability Layer: Loading...');\n\n    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n    // 1. CRITICAL ERROR BOUNDARY\n    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n    // Prevents app crashes from ANY JavaScript error\n\n    window.addEventListener('error', function (event) {\n        console.error('âŒ Error caught:', event.error);\n        event.preventDefault();\n\n        // Log for debugging but don't crash app\n        if (typeof window.errorLog === 'undefined') {\n            window.errorLog = [];\n        }\n        window.errorLog.push({\n            message: event.message,\n            source: event.filename,\n            line: event.lineno,\n            time: new Date().toISOString()\n        });\n\n        return true; // Prevent default error handling\n    });\n\n    window.addEventListener('unhandledrejection', function (event) {\n        console.error('âŒ Unhandled Promise:', event.reason);\n        event.preventDefault();\n        return true;\n    });\n\n    return true;\n});\n\nconsole.log('âœ… Error Boundary: Active');\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// 2. RENDER THROTTLING\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// Prevents excessive DOM updates that cause lag\n\nlet pendingReads: Array<() => void> = [];\nlet pendingWrites: Array<() => void> = [];\nlet scheduled = false;\n\nfunction flushQueue() {\n    // Batch all reads\n    pendingReads.forEach(fn => {\n        try { fn(); } catch (e) { console.error(e); }\n    });\n    pendingReads = [];\n\n    // Then all writes\n    pendingWrites.forEach(fn => {\n        try { fn(); } catch (e) { console.error(e); }\n    });\n    pendingWrites = [];\n\n    scheduled = false;\n}\n\nwindow.batchRead = function (fn: () => void) {\n    pendingReads.push(fn);\n    if (!scheduled) {\n        scheduled = true;\n        requestAnimationFrame(flushQueue);\n    }\n};\n\nwindow.batchWrite = function (fn: () => void) {\n    pendingWrites.push(fn);\n    if (!scheduled) {\n        scheduled = true;\n        requestAnimationFrame(flushQueue);\n    }\n};\n\nconsole.log('âœ… Render Throttling: Active');\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// 3. CANVAS OPTIMIZATION\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// If using canvas, prevent memory leaks\n\nconst canvasContexts = new WeakMap();\n\nconst originalGetContext = HTMLCanvasElement.prototype.getContext;\n// @ts-ignore - Override signature is widely compatible but strict types sometimes complain\nHTMLCanvasElement.prototype.getContext = function (type: string, options?: any) {\n    const context = (originalGetContext as any).call(this, type, options);\n\n    if (context && !canvasContexts.has(this)) {\n        canvasContexts.set(this, context);\n\n        // Add auto-cleanup when canvas is removed\n        const observer = new MutationObserver(() => {\n            if (!this.isConnected) {\n                if (context instanceof CanvasRenderingContext2D) {\n                    context.clearRect(0, 0, this.width, this.height);\n                }\n                observer.disconnect();\n            }\n        });\n\n        if (this.parentNode) {\n            observer.observe(this.parentNode, { childList: true });\n        }\n    }\n\n    return context;\n};\n\nconsole.log('âœ… Canvas Optimization: Active');\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// 4. IMAGE LOADING OPTIMIZATION\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// Prevent loading failures and optimize delivery\n\nconst imageLoadQueue: Array<{\n    img: HTMLImageElement;\n    src: string;\n    resolve: (img: HTMLImageElement) => void;\n    reject: (err: Error) => void;\n}> = [];\nlet loadingImages = 0;\nconst MAX_CONCURRENT_IMAGES = 4;\n\nfunction processImageQueue() {\n    while (loadingImages < MAX_CONCURRENT_IMAGES && imageLoadQueue.length > 0) {\n        const item = imageLoadQueue.shift();\n        if (!item) break;\n        const { img, src, resolve, reject } = item;\n        loadingImages++;\n\n        img.onload = () => {\n            loadingImages--;\n            resolve(img);\n            processImageQueue();\n        };\n\n        img.onerror = () => {\n            loadingImages--;\n            console.warn('Image load failed:', src);\n\n            // Retry once\n            setTimeout(() => {\n                img.src = src;\n            }, 1000);\n\n            reject(new Error('Image load failed'));\n            processImageQueue();\n        };\n\n        img.src = src;\n    }\n}\n\nwindow.loadImageOptimized = function (src: string) {\n    return new Promise((resolve, reject) => {\n        const img = new Image();\n        imageLoadQueue.push({ img, src, resolve, reject });\n        processImageQueue();\n    });\n};\n\nconsole.log('âœ… Image Loading Optimization: Active');\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// 5. TOUCH/GESTURE OPTIMIZATION\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// Better touch performance on mobile\n\nlet touchStartX = 0;\nlet touchStartY = 0;\nlet isSwiping = false;\n\ndocument.addEventListener('touchstart', function (e) {\n    touchStartX = e.touches[0].clientX;\n    touchStartY = e.touches[0].clientY;\n    isSwiping = false;\n}, { passive: true });\n\ndocument.addEventListener('touchmove', function (e) {\n    if (!isSwiping) {\n        const deltaX = Math.abs(e.touches[0].clientX - touchStartX);\n        const deltaY = Math.abs(e.touches[0].clientY - touchStartY);\n\n        if (deltaX > 10 || deltaY > 10) {\n            isSwiping = true;\n        }\n    }\n}, { passive: true });\n\nconsole.log('âœ… Touch Optimization: Active');\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// 6. RESOURCE HINTS\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// Preload critical resources automatically\n\nfunction addResourceHints() {\n    const links = [\n        { rel: 'dns-prefetch', href: 'https://fonts.googleapis.com' },\n        { rel: 'preconnect', href: 'https://fonts.gstatic.com', crossorigin: true }\n    ];\n\n    links.forEach(({ rel, href, crossorigin }) => {\n        const link = document.createElement('link');\n        link.rel = rel;\n        link.href = href;\n        if (crossorigin) link.crossOrigin = 'anonymous';\n        document.head.appendChild(link);\n    });\n}\n\nif (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', addResourceHints);\n} else {\n    addResourceHints();\n}\n\nconsole.log('âœ… Resource Hints: Active');\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// 7. NETWORK ERROR RECOVERY\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// Auto-retry failed network requests\n\nconst originalFetch = window.fetch;\nwindow.fetch = function (input: RequestInfo | URL, init?: RequestInit): Promise<Response> {\n    const maxRetries = 3;\n    let retryCount = 0;\n\n    function attemptFetch(): Promise<Response> {\n        return originalFetch(input, init)\n            .catch((error: unknown) => {\n                retryCount++;\n                if (retryCount <= maxRetries) {\n                    const urlStr = typeof input === 'string' ? input : 'resource';\n                    console.warn(`Fetch retry ${retryCount}/${maxRetries}:`, urlStr);\n                    return new Promise((resolve) => {\n                        setTimeout(() => resolve(attemptFetch()), 1000 * retryCount);\n                    });\n                }\n                throw error;\n            });\n    }\n\n    return attemptFetch();\n};\n\nconsole.log('âœ… Network Error Recovery: Active');\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// 8. FOCUS MANAGEMENT\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// Optimize performance when window loses focus\n\nlet wasHidden = false;\n\ndocument.addEventListener('visibilitychange', function () {\n    if (document.hidden && !wasHidden) {\n        wasHidden = true;\n\n        // Pause heavy operations\n        document.querySelectorAll('video, audio').forEach(el => {\n            const media = el as HTMLMediaElement;\n            if (!media.paused) {\n                media.pause();\n                media.dataset.wasPlaying = 'true';\n            }\n        });\n\n        console.log('â¸ï¸ App paused (hidden)');\n\n    } else if (!document.hidden && wasHidden) {\n        wasHidden = false;\n\n        // Resume\n        document.querySelectorAll('video, audio').forEach(el => {\n            const media = el as HTMLMediaElement;\n            if (media.dataset.wasPlaying === 'true') {\n                media.play();\n                delete media.dataset.wasPlaying;\n            }\n        });\n\n        // Clear any accumulated tasks\n        if (window.gc) {\n            try { window.gc(); } catch (e) { }\n        }\n\n        console.log('â–¶ï¸ App resumed (visible)');\n    }\n});\n\nconsole.log('âœ… Focus Management: Active');\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// 9. SCROLL PERFORMANCE\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// Optimize scroll performance\n\nlet ticking = false;\nlet lastScrollY = window.scrollY;\n\nfunction optimizeScroll() {\n    // lastScrollY = window.scrollY;\n    ticking = false;\n}\n\nwindow.addEventListener('scroll', function () {\n    if (!ticking) {\n        window.requestAnimationFrame(optimizeScroll);\n        ticking = true;\n    }\n}, { passive: true });\n\nconsole.log('âœ… Scroll Optimization: Active');\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// 10. ORIENTATION CHANGE HANDLER\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// Handle device rotation smoothly\n\nlet orientationTimeout: any;\n\nwindow.addEventListener('orientationchange', function () {\n    clearTimeout(orientationTimeout);\n\n    // Pause animations during rotation\n    document.body.style.animation = 'none';\n\n    orientationTimeout = setTimeout(() => {\n        // Re-enable after rotation complete\n        document.body.style.animation = '';\n\n        // Trigger resize event\n        window.dispatchEvent(new Event('resize'));\n\n        console.log('ğŸ”„ Orientation adjusted');\n    }, 300);\n});\n\nconsole.log('âœ… Orientation Handler: Active');\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// 11. MEMORY PRESSURE DETECTION\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// Detect and respond to low memory\n\nif (performance.memory) {\n    setInterval(() => {\n        const mem = performance.memory;\n        if (!mem) return;\n\n        const memoryUsage = mem.usedJSHeapSize / mem.jsHeapSizeLimit;\n\n        if (memoryUsage > 0.9) {\n            console.warn('âš ï¸ High memory usage detected:', (memoryUsage * 100).toFixed(1) + '%');\n\n            // Emergency cleanup\n            if (window.gc) {\n                try { window.gc(); } catch (e) { }\n            }\n\n            // Reduce quality temporarily\n            document.body.dataset.lowMemory = 'true';\n\n            // Restore after cleanup\n            setTimeout(() => {\n                delete document.body.dataset.lowMemory;\n            }, 5000);\n        }\n    }, 10000);\n}\n\nconsole.log('âœ… Memory Pressure Detection: Active');\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// 12. SAFE ANIMATION CLEANUP\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// Ensure animations don't leak\n\nconst runningAnimations = new WeakMap();\n\nconst originalAnimate = Element.prototype.animate;\nElement.prototype.animate = function (keyframes, options) {\n    const animation = originalAnimate.call(this, keyframes, options);\n\n    if (!runningAnimations.has(this)) {\n        runningAnimations.set(this, new Set());\n    }\n    runningAnimations.get(this).add(animation);\n\n    animation.addEventListener('finish', () => {\n        const anims = runningAnimations.get(this);\n        if (anims) anims.delete(animation);\n    });\n\n    animation.addEventListener('cancel', () => {\n        const anims = runningAnimations.get(this);\n        if (anims) anims.delete(animation);\n    });\n\n    return animation;\n};\n\n// Cleanup animations when elements are removed\nconst animationObserver = new MutationObserver((mutations) => {\n    mutations.forEach((mutation) => {\n        mutation.removedNodes.forEach((node) => {\n            if (node.nodeType === 1) { // Element node\n                const anims = runningAnimations.get(node);\n                if (anims) {\n                    anims.forEach((anim: any) => anim.cancel());\n                    anims.clear();\n                }\n            }\n        });\n    });\n});\n\nanimationObserver.observe(document.body, {\n    childList: true,\n    subtree: true\n});\n\nconsole.log('âœ… Animation Cleanup: Active');\n\nconsole.log('ğŸ‰ Additional Stability Layer: Complete!');\n\n// }) ();\n\nexport default {};\n","usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/utils/textureLoader.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/src/utils/textureManager.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/ibrahimaltukhaim/.gemini/antigravity/scratch/astronomy-app/vite.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
